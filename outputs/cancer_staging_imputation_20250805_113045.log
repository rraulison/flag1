2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - Initializing pipeline components...
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - Pipeline initialized successfully. Output will be saved to: /home/remo/inca/flag1/outputs/cancer_staging_imputation_20250805_113045
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - ================================================================================
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - STARTING PIPELINE EXECUTION - 2025-08-05 11:30:45.351629
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - ================================================================================
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - 
==================================================
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - STEP 1/4: LOADING AND PREPROCESSING DATA
2025-08-05 11:30:45,351 - flag1.src.pipeline - INFO - ==================================================
2025-08-05 11:30:45,351 - flag1.src.data_processing - INFO - Loading data from /home/remo/inca/flag1/data/df_preprocessed.parquet
2025-08-05 11:30:45,901 - flag1.src.data_processing - INFO - Loading feature importance from /home/remo/inca/flag1/data/results/selected_features_cv.csv
2025-08-05 11:30:45,904 - flag1.src.data_processing - INFO - Selected 26 features.
2025-08-05 11:30:46,062 - flag1.src.data_processing - INFO - Distribution of flag_nao_estadiavel:
flag_nao_estadiavel
0.0    1420537
NaN    1053932
1.0     402028
Name: count, dtype: int64
2025-08-05 11:30:46,083 - flag1.src.data_processing - INFO - Distribution of estadiamento_ordinal:
estadiamento_ordinal
0.0      63256
1.0     299066
2.0     360358
3.0     345896
4.0     351961
NaN    1455960
Name: count, dtype: int64
2025-08-05 11:30:46,105 - flag1.src.data_processing - INFO - Columns with missing data: ['LOCTUDET', 'LOCTUPRI', 'OUTROESTA', 'DTTRIAGE', 'ANTRI', 'DATAINITRT', 'flag_nao_estadiavel', 'estadiamento_ordinal']
2025-08-05 11:30:46,107 - flag1.src.data_processing - INFO -   LOCTUDET: 3 missing values
2025-08-05 11:30:46,108 - flag1.src.data_processing - INFO -   LOCTUPRI: 3 missing values
2025-08-05 11:30:46,110 - flag1.src.data_processing - INFO -   OUTROESTA: 31596 missing values
2025-08-05 11:30:46,112 - flag1.src.data_processing - INFO -   DTTRIAGE: 379706 missing values
2025-08-05 11:30:46,113 - flag1.src.data_processing - INFO -   ANTRI: 379706 missing values
2025-08-05 11:30:46,115 - flag1.src.data_processing - INFO -   DATAINITRT: 495167 missing values
2025-08-05 11:30:46,118 - flag1.src.data_processing - INFO -   flag_nao_estadiavel: 1053932 missing values
2025-08-05 11:30:46,121 - flag1.src.data_processing - INFO -   estadiamento_ordinal: 1455960 missing values
2025-08-05 11:30:46,483 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: TNM
2025-08-05 11:30:46,820 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: CNES
2025-08-05 11:30:46,958 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: T
2025-08-05 11:30:47,333 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: MUUH
2025-08-05 11:30:47,456 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: LOCTUDET
2025-08-05 11:30:47,596 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: M
2025-08-05 11:30:47,719 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: LOCTUPRI
2025-08-05 11:30:48,046 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: PTNM
2025-08-05 11:30:48,323 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: UFUH
2025-08-05 11:30:48,626 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: PRITRATH
2025-08-05 11:30:48,764 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: N
2025-08-05 11:30:48,903 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: pT
2025-08-05 11:30:49,042 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: pM
2025-08-05 11:30:49,175 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: OUTROESTA
2025-08-05 11:30:49,449 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: CLITRAT
2025-08-05 11:30:49,587 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: ESTDFIMT
2025-08-05 11:30:49,869 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: ESTADRES
2025-08-05 11:30:50,255 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: CLIATEN
2025-08-05 11:30:50,394 - flag1.src.data_processing - INFO - Corrected categorical column to handle NaN as string: pN
2025-08-05 11:30:50,394 - flag1.src.pipeline - INFO - ✓ Data loaded and preprocessed successfully. Shape: (2876497, 28)
2025-08-05 11:30:50,394 - flag1.src.pipeline - INFO -   Features: 27 total, 19 categorical
2025-08-05 11:30:57,110 - flag1.src.pipeline - DEBUG - DataFrame memory usage: 2815.27 MB
2025-08-05 11:30:57,110 - flag1.src.pipeline - INFO - 
==================================================
2025-08-05 11:30:57,110 - flag1.src.pipeline - INFO - STEP 2/4: RUNNING IMPUTATION
2025-08-05 11:30:57,110 - flag1.src.pipeline - INFO - ==================================================
2025-08-05 11:30:57,110 - flag1.src.imputation - INFO - Starting imputation loop with 100 iterations.
2025-08-05 11:30:57,110 - flag1.src.imputation - INFO - Starting imputation 1/100
2025-08-05 11:31:02,022 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:31:02,022 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:31:02,022 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:31:02,022 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:31:02,938 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 11:32:57,030 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:32:57,030 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:32:57,030 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:32:57,035 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:32:57,036 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:32:57,042 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135688), 1: np.int64(322364)}
2025-08-05 11:32:57,043 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283922), 1: np.int64(80591)}
2025-08-05 11:32:57,044 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:32:57,046 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.849884
3     LOCTUPRI   16.510171
11  DATAPRICON   10.795501
2     LOCTUDET    9.684761
10       ANTRI    4.433762
5     PRITRATH    4.418566
6      CLITRAT    4.416350
8      CLIATEN    4.236381
1         MUUH    3.744630
9     DTTRIAGE    3.653903
2025-08-05 11:32:58,378 - flag1.src.imputation - INFO - Binary model - Iter 1 - Val LogLoss: 0.2027 - Accuracy: 0.9364 - Classes: [0 1]
2025-08-05 11:32:58,381 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.849884
3     LOCTUPRI   16.510171
11  DATAPRICON   10.795501
2     LOCTUDET    9.684761
10       ANTRI    4.433762
5     PRITRATH    4.418566
6      CLITRAT    4.416350
8      CLIATEN    4.236381
1         MUUH    3.744630
9     DTTRIAGE    3.653903
2025-08-05 11:32:59,468 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:33:02,465 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:33:05,448 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:33:05,907 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 11:33:07,739 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:33:07,739 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:33:07,739 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:33:14,643 - flag1.src.imputation - DEBUG - Training ordinal model with 1121254 samples. Class distribution:
estadiamento_ordinal
0     50784
1    237868
2    295889
3    281098
4    255615
Name: count, dtype: int64
2025-08-05 11:33:14,651 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.415776622558286, 1: 0.9427531235811458, 2: 0.7578882621523612, 3: 0.7977673266974508, 4: 0.877299063044031}
2025-08-05 11:33:41,139 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:33:41,139 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:33:41,139 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:33:41,142 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:33:41,143 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:33:41,147 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236711), 3: np.int64(224878), 4: np.int64(204492), 1: np.int64(190295), 0: np.int64(40627)}
2025-08-05 11:33:41,148 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59178), 3: np.int64(56220), 4: np.int64(51123), 1: np.int64(47573), 0: np.int64(10157)}
2025-08-05 11:33:41,149 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:33:41,149 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.812924
2          T   17.033421
4   LOCTUDET   11.996211
5          M    8.891082
11        pT    6.277587
6   LOCTUPRI    5.215395
1       CNES    4.724981
10         N    3.665972
15  ESTDFIMT    3.572129
7       PTNM    2.799146
2025-08-05 11:33:42,078 - flag1.src.imputation - INFO - Ordinal model - Iter 1 - Val LogLoss: 0.5070 - Accuracy: 0.8475 - Classes: [0 1 2 3 4]
2025-08-05 11:33:42,081 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.812924
2          T   17.033421
4   LOCTUDET   11.996211
5          M    8.891082
11        pT    6.277587
6   LOCTUPRI    5.215395
1       CNES    4.724981
10         N    3.665972
15  ESTDFIMT    3.572129
7       PTNM    2.799146
2025-08-05 11:33:43,291 - root - DEBUG - Processed 50000/643353 samples (7.8%)
2025-08-05 11:33:46,603 - root - DEBUG - Processed 550000/643353 samples (85.5%)
2025-08-05 11:34:01,590 - flag1.src.imputation - INFO - Imputed 643353 MAR values.
2025-08-05 11:34:12,318 - flag1.src.imputation - INFO - Imputed 643353 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:34:23,158 - flag1.src.imputation - INFO - Imputed 643353 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:34:24,732 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:34:24,740 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812607
4     583516
2     486333
3     481184
1     422165
0      90692
99         0
Name: count, dtype: int64
2025-08-05 11:34:25,950 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:34:25,959 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812607
4     595447
3     500473
2     464728
1     410320
0      92922
99         0
Name: count, dtype: int64
2025-08-05 11:34:27,180 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:34:27,190 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812607
4     704531
2     450632
3     429595
1     389300
0      89832
99         0
Name: count, dtype: int64
2025-08-05 11:34:27,998 - flag1.src.imputation - INFO - Completed imputation 1/100 in 210.89 seconds
2025-08-05 11:34:27,998 - flag1.src.imputation - INFO - Estimated time remaining: 348.0 minutes
2025-08-05 11:34:27,998 - root - DEBUG - Imputation 1 completed in 210.89s
2025-08-05 11:34:27,998 - flag1.src.imputation - INFO - Starting imputation 2/100
2025-08-05 11:34:32,878 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:34:32,878 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:34:32,878 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:34:32,878 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:34:33,796 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 11:36:28,209 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:36:28,209 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:36:28,209 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:36:28,214 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:36:28,215 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:36:28,221 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136619), 1: np.int64(321433)}
2025-08-05 11:36:28,222 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284155), 1: np.int64(80358)}
2025-08-05 11:36:28,223 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:36:28,224 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.716840
3     LOCTUPRI   16.171868
11  DATAPRICON   10.451589
2     LOCTUDET    9.872107
6      CLITRAT    4.855129
10       ANTRI    4.852811
9     DTTRIAGE    4.236111
8      CLIATEN    4.097097
5     PRITRATH    4.005733
1         MUUH    3.584202
2025-08-05 11:36:29,574 - flag1.src.imputation - INFO - Binary model - Iter 2 - Val LogLoss: 0.2021 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 11:36:29,577 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.716840
3     LOCTUPRI   16.171868
11  DATAPRICON   10.451589
2     LOCTUDET    9.872107
6      CLITRAT    4.855129
10       ANTRI    4.852811
9     DTTRIAGE    4.236111
8      CLIATEN    4.097097
5     PRITRATH    4.005733
1         MUUH    3.584202
2025-08-05 11:36:30,658 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:36:33,707 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:36:36,701 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:36:37,177 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 11:36:38,997 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:36:38,997 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:36:38,997 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:36:45,819 - flag1.src.imputation - DEBUG - Training ordinal model with 1121608 samples. Class distribution:
estadiamento_ordinal
0     50523
1    238154
2    295865
3    281325
4    255741
Name: count, dtype: int64
2025-08-05 11:36:45,828 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.439989707657898, 1: 0.941918254574771, 2: 0.7581890389197776, 3: 0.7973752777037234, 4: 0.8771436727001146}
2025-08-05 11:37:12,149 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:37:12,149 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:37:12,149 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:37:12,152 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:37:12,153 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:37:12,156 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236692), 3: np.int64(225060), 4: np.int64(204593), 1: np.int64(190523), 0: np.int64(40418)}
2025-08-05 11:37:12,158 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59173), 3: np.int64(56265), 4: np.int64(51148), 1: np.int64(47631), 0: np.int64(10105)}
2025-08-05 11:37:12,158 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:37:12,159 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.324435
2          T   17.174312
4   LOCTUDET   10.258964
5          M    8.721886
6   LOCTUPRI    6.362292
11        pT    6.074163
1       CNES    4.745056
10         N    3.722277
15  ESTDFIMT    3.512308
3       MUUH    2.906948
2025-08-05 11:37:13,045 - flag1.src.imputation - INFO - Ordinal model - Iter 2 - Val LogLoss: 0.5057 - Accuracy: 0.8483 - Classes: [0 1 2 3 4]
2025-08-05 11:37:13,048 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.324435
2          T   17.174312
4   LOCTUDET   10.258964
5          M    8.721886
6   LOCTUPRI    6.362292
11        pT    6.074163
1       CNES    4.745056
10         N    3.722277
15  ESTDFIMT    3.512308
3       MUUH    2.906948
2025-08-05 11:37:14,269 - root - DEBUG - Processed 50000/644378 samples (7.8%)
2025-08-05 11:37:17,637 - root - DEBUG - Processed 550000/644378 samples (85.4%)
2025-08-05 11:37:32,604 - flag1.src.imputation - INFO - Imputed 644378 MAR values.
2025-08-05 11:37:43,359 - flag1.src.imputation - INFO - Imputed 644378 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:37:54,205 - flag1.src.imputation - INFO - Imputed 644378 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:37:55,773 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:37:55,782 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811582
4     579698
2     488577
3     484032
1     423804
0      88804
99         0
Name: count, dtype: int64
2025-08-05 11:37:56,998 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:37:57,007 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811582
4     592778
3     505350
2     467248
1     409211
0      90328
99         0
Name: count, dtype: int64
2025-08-05 11:37:58,225 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:37:58,233 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811582
4     704982
2     455219
3     428508
1     386946
0      89260
99         0
Name: count, dtype: int64
2025-08-05 11:37:59,043 - flag1.src.imputation - INFO - Completed imputation 2/100 in 211.04 seconds
2025-08-05 11:37:59,043 - flag1.src.imputation - INFO - Estimated time remaining: 172.4 minutes
2025-08-05 11:37:59,043 - root - DEBUG - Imputation 2 completed in 211.04s
2025-08-05 11:37:59,043 - flag1.src.imputation - INFO - Starting imputation 3/100
2025-08-05 11:38:03,918 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:38:03,918 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:38:03,918 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:38:03,918 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:38:04,843 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 11:40:00,051 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:40:00,051 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:40:00,051 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:40:00,056 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:40:00,057 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:40:00,063 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1137196), 1: np.int64(320856)}
2025-08-05 11:40:00,065 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284299), 1: np.int64(80214)}
2025-08-05 11:40:00,065 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:40:00,066 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.192199
3     LOCTUPRI   16.388775
11  DATAPRICON   11.396531
2     LOCTUDET    9.687284
10       ANTRI    4.924243
6      CLITRAT    4.570158
8      CLIATEN    4.236319
5     PRITRATH    4.212623
9     DTTRIAGE    4.167349
1         MUUH    3.323250
2025-08-05 11:40:01,437 - flag1.src.imputation - INFO - Binary model - Iter 3 - Val LogLoss: 0.2010 - Accuracy: 0.9367 - Classes: [0 1]
2025-08-05 11:40:01,440 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.192199
3     LOCTUPRI   16.388775
11  DATAPRICON   11.396531
2     LOCTUDET    9.687284
10       ANTRI    4.924243
6      CLITRAT    4.570158
8      CLIATEN    4.236319
5     PRITRATH    4.212623
9     DTTRIAGE    4.167349
1         MUUH    3.323250
2025-08-05 11:40:02,537 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:40:05,517 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:40:08,546 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:40:09,020 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.7% as 'não estadiável' (1), 61.3% as 'estadiável' (0)
2025-08-05 11:40:10,845 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:40:10,845 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:40:10,845 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:40:17,656 - flag1.src.imputation - DEBUG - Training ordinal model with 1121649 samples. Class distribution:
estadiamento_ordinal
0     50748
1    238762
2    295177
3    281045
4    255917
Name: count, dtype: int64
2025-08-05 11:40:17,665 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.42046583116576, 1: 0.9395540328863052, 2: 0.7599840095942435, 3: 0.7981988649504528, 4: 0.8765724824845555}
2025-08-05 11:40:44,163 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:40:44,163 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:40:44,163 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:40:44,166 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:40:44,166 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:40:44,170 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236141), 3: np.int64(224836), 4: np.int64(204734), 1: np.int64(191010), 0: np.int64(40598)}
2025-08-05 11:40:44,171 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59036), 3: np.int64(56209), 4: np.int64(51183), 1: np.int64(47752), 0: np.int64(10150)}
2025-08-05 11:40:44,172 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:40:44,173 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.069195
2          T   16.913432
4   LOCTUDET   10.797823
5          M    8.925851
11        pT    6.433779
6   LOCTUPRI    6.248055
1       CNES    4.752995
15  ESTDFIMT    3.484765
10         N    3.427428
3       MUUH    2.808749
2025-08-05 11:40:45,045 - flag1.src.imputation - INFO - Ordinal model - Iter 3 - Val LogLoss: 0.5076 - Accuracy: 0.8484 - Classes: [0 1 2 3 4]
2025-08-05 11:40:45,048 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.069195
2          T   16.913432
4   LOCTUDET   10.797823
5          M    8.925851
11        pT    6.433779
6   LOCTUPRI    6.248055
1       CNES    4.752995
15  ESTDFIMT    3.484765
10         N    3.427428
3       MUUH    2.808749
2025-08-05 11:40:46,255 - root - DEBUG - Processed 50000/645889 samples (7.7%)
2025-08-05 11:40:49,583 - root - DEBUG - Processed 550000/645889 samples (85.2%)
2025-08-05 11:41:04,652 - flag1.src.imputation - INFO - Imputed 645889 MAR values.
2025-08-05 11:41:15,464 - flag1.src.imputation - INFO - Imputed 645889 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:41:26,343 - flag1.src.imputation - INFO - Imputed 645889 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:41:27,914 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:41:27,923 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810071
4     582339
2     489776
3     483239
1     423056
0      88016
99         0
Name: count, dtype: int64
2025-08-05 11:41:29,139 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:41:29,148 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810071
4     596664
3     502257
2     467758
1     412855
0      86892
99         0
Name: count, dtype: int64
2025-08-05 11:41:30,368 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:41:30,377 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810071
4     704602
2     455792
3     431079
1     387102
0      87851
99         0
Name: count, dtype: int64
2025-08-05 11:41:31,187 - flag1.src.imputation - INFO - Completed imputation 3/100 in 212.14 seconds
2025-08-05 11:41:31,187 - flag1.src.imputation - INFO - Estimated time remaining: 114.3 minutes
2025-08-05 11:41:31,187 - root - DEBUG - Imputation 3 completed in 212.14s
2025-08-05 11:41:31,187 - flag1.src.imputation - INFO - Starting imputation 4/100
2025-08-05 11:41:36,108 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:41:36,109 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:41:36,109 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:41:36,109 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:41:37,025 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 11:43:33,171 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:43:33,171 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:43:33,171 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:43:33,176 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:43:33,177 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:43:33,183 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136374), 1: np.int64(321678)}
2025-08-05 11:43:33,184 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284094), 1: np.int64(80419)}
2025-08-05 11:43:33,185 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:43:33,186 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.757379
3     LOCTUPRI   15.898590
11  DATAPRICON   10.685379
2     LOCTUDET   10.134043
6      CLITRAT    4.737439
9     DTTRIAGE    4.526307
10       ANTRI    4.416644
5     PRITRATH    4.197337
8      CLIATEN    3.935745
1         MUUH    3.811085
2025-08-05 11:43:34,549 - flag1.src.imputation - INFO - Binary model - Iter 4 - Val LogLoss: 0.2014 - Accuracy: 0.9368 - Classes: [0 1]
2025-08-05 11:43:34,552 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.757379
3     LOCTUPRI   15.898590
11  DATAPRICON   10.685379
2     LOCTUDET   10.134043
6      CLITRAT    4.737439
9     DTTRIAGE    4.526307
10       ANTRI    4.416644
5     PRITRATH    4.197337
8      CLIATEN    3.935745
1         MUUH    3.811085
2025-08-05 11:43:35,641 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:43:38,688 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:43:41,708 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:43:42,180 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 11:43:43,996 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:43:43,996 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:43:43,996 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:43:50,836 - flag1.src.imputation - DEBUG - Training ordinal model with 1122218 samples. Class distribution:
estadiamento_ordinal
0     51030
1    238855
2    295315
3    281439
4    255579
Name: count, dtype: int64
2025-08-05 11:43:50,844 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.398267685675093, 1: 0.939664650101526, 2: 0.7600142221018235, 3: 0.7974857784457733, 4: 0.8781770020228579}
2025-08-05 11:44:17,555 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:44:17,555 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:44:17,555 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:44:17,558 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:44:17,558 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:44:17,562 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236252), 3: np.int64(225151), 4: np.int64(204463), 1: np.int64(191084), 0: np.int64(40824)}
2025-08-05 11:44:17,563 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59063), 3: np.int64(56288), 4: np.int64(51116), 1: np.int64(47771), 0: np.int64(10206)}
2025-08-05 11:44:17,564 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:44:17,565 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.414272
2          T   16.800419
4   LOCTUDET   11.224674
5          M    8.748858
11        pT    6.130659
6   LOCTUPRI    5.953149
1       CNES    4.802428
10         N    3.595615
15  ESTDFIMT    3.463269
3       MUUH    2.654627
2025-08-05 11:44:18,465 - flag1.src.imputation - INFO - Ordinal model - Iter 4 - Val LogLoss: 0.5047 - Accuracy: 0.8489 - Classes: [0 1 2 3 4]
2025-08-05 11:44:18,469 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.414272
2          T   16.800419
4   LOCTUDET   11.224674
5          M    8.748858
11        pT    6.130659
6   LOCTUPRI    5.953149
1       CNES    4.802428
10         N    3.595615
15  ESTDFIMT    3.463269
3       MUUH    2.654627
2025-08-05 11:44:19,673 - root - DEBUG - Processed 50000/644179 samples (7.8%)
2025-08-05 11:44:23,005 - root - DEBUG - Processed 550000/644179 samples (85.4%)
2025-08-05 11:44:38,039 - flag1.src.imputation - INFO - Imputed 644179 MAR values.
2025-08-05 11:44:48,816 - flag1.src.imputation - INFO - Imputed 644179 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:44:59,669 - flag1.src.imputation - INFO - Imputed 644179 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:45:01,241 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:45:01,249 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811781
4     579140
2     489057
3     485753
1     423962
0      86804
99         0
Name: count, dtype: int64
2025-08-05 11:45:02,461 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:45:02,470 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811781
4     592165
3     504886
2     469211
1     411669
0      86785
99         0
Name: count, dtype: int64
2025-08-05 11:45:03,688 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:45:03,697 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811781
4     709992
2     451131
3     434182
1     383628
0      85783
99         0
Name: count, dtype: int64
2025-08-05 11:45:04,506 - flag1.src.imputation - INFO - Completed imputation 4/100 in 213.32 seconds
2025-08-05 11:45:04,506 - flag1.src.imputation - INFO - Estimated time remaining: 85.3 minutes
2025-08-05 11:45:04,506 - root - DEBUG - Imputation 4 completed in 213.32s
2025-08-05 11:45:04,506 - flag1.src.imputation - INFO - Starting imputation 5/100
2025-08-05 11:45:09,385 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:45:09,385 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:45:09,386 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:45:09,386 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:45:10,297 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 11:47:06,002 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:47:06,003 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:47:06,003 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:47:06,008 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:47:06,009 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:47:06,014 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136558), 1: np.int64(321494)}
2025-08-05 11:47:06,016 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284140), 1: np.int64(80373)}
2025-08-05 11:47:06,017 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:47:06,018 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.641327
3     LOCTUPRI   14.858864
2     LOCTUDET   10.584612
11  DATAPRICON   10.480043
6      CLITRAT    4.570841
10       ANTRI    4.523646
1         MUUH    4.404745
5     PRITRATH    4.288235
9     DTTRIAGE    4.222378
8      CLIATEN    4.048499
2025-08-05 11:47:07,398 - flag1.src.imputation - INFO - Binary model - Iter 5 - Val LogLoss: 0.2030 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 11:47:07,401 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.641327
3     LOCTUPRI   14.858864
2     LOCTUDET   10.584612
11  DATAPRICON   10.480043
6      CLITRAT    4.570841
10       ANTRI    4.523646
1         MUUH    4.404745
5     PRITRATH    4.288235
9     DTTRIAGE    4.222378
8      CLIATEN    4.048499
2025-08-05 11:47:08,501 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:47:11,590 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:47:14,620 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:47:15,083 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.7% as 'não estadiável' (1), 61.3% as 'estadiável' (0)
2025-08-05 11:47:16,912 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:47:16,912 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:47:16,912 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:47:23,626 - flag1.src.imputation - DEBUG - Training ordinal model with 1122382 samples. Class distribution:
estadiamento_ordinal
0     50694
1    238864
2    295537
3    281225
4    256062
Name: count, dtype: int64
2025-08-05 11:47:23,634 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.428066437842743, 1: 0.9397665617255007, 2: 0.759554302845329, 3: 0.798209263045604, 4: 0.8766486241613359}
2025-08-05 11:47:50,287 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:47:50,287 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:47:50,287 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:47:50,291 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:47:50,292 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:47:50,300 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236429), 3: np.int64(224980), 4: np.int64(204850), 1: np.int64(191091), 0: np.int64(40555)}
2025-08-05 11:47:50,303 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59108), 3: np.int64(56245), 4: np.int64(51212), 1: np.int64(47773), 0: np.int64(10139)}
2025-08-05 11:47:50,304 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:47:50,305 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.298839
2          T   17.369630
4   LOCTUDET   11.732862
5          M    8.850776
11        pT    6.194574
6   LOCTUPRI    5.322429
1       CNES    4.844293
15  ESTDFIMT    3.610596
10         N    3.484279
7       PTNM    2.587903
2025-08-05 11:47:51,202 - flag1.src.imputation - INFO - Ordinal model - Iter 5 - Val LogLoss: 0.5060 - Accuracy: 0.8473 - Classes: [0 1 2 3 4]
2025-08-05 11:47:51,205 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.298839
2          T   17.369630
4   LOCTUDET   11.732862
5          M    8.850776
11        pT    6.194574
6   LOCTUPRI    5.322429
1       CNES    4.844293
15  ESTDFIMT    3.610596
10         N    3.484279
7       PTNM    2.587903
2025-08-05 11:47:52,418 - root - DEBUG - Processed 50000/646221 samples (7.7%)
2025-08-05 11:47:55,760 - root - DEBUG - Processed 550000/646221 samples (85.1%)
2025-08-05 11:48:10,974 - flag1.src.imputation - INFO - Imputed 646221 MAR values.
2025-08-05 11:48:21,819 - flag1.src.imputation - INFO - Imputed 646221 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:48:32,724 - flag1.src.imputation - INFO - Imputed 646221 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:48:34,287 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:48:34,295 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809739
4     580601
2     488171
3     484722
1     427885
0      85379
99         0
Name: count, dtype: int64
2025-08-05 11:48:35,512 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:48:35,521 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809739
4     594268
3     506416
2     467273
1     411073
0      87728
99         0
Name: count, dtype: int64
2025-08-05 11:48:36,739 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:48:36,749 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809739
4     707029
2     450699
3     430431
1     387010
0      91589
99         0
Name: count, dtype: int64
2025-08-05 11:48:37,557 - flag1.src.imputation - INFO - Completed imputation 5/100 in 213.05 seconds
2025-08-05 11:48:37,557 - flag1.src.imputation - INFO - Estimated time remaining: 67.5 minutes
2025-08-05 11:48:37,557 - root - DEBUG - Imputation 5 completed in 213.05s
2025-08-05 11:48:37,557 - flag1.src.imputation - INFO - Starting imputation 6/100
2025-08-05 11:48:42,456 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:48:42,456 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:48:42,456 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:48:42,456 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:48:43,380 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 11:50:38,968 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:50:38,968 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:50:38,968 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:50:38,973 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:50:38,974 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:50:38,980 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136091), 1: np.int64(321961)}
2025-08-05 11:50:38,981 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284023), 1: np.int64(80490)}
2025-08-05 11:50:38,982 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:50:38,983 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.522724
3     LOCTUPRI   15.659241
2     LOCTUDET   10.141197
11  DATAPRICON    9.940706
10       ANTRI    4.866839
6      CLITRAT    4.507463
9     DTTRIAGE    4.305215
1         MUUH    4.193880
5     PRITRATH    4.122993
8      CLIATEN    4.088073
2025-08-05 11:50:40,335 - flag1.src.imputation - INFO - Binary model - Iter 6 - Val LogLoss: 0.2008 - Accuracy: 0.9374 - Classes: [0 1]
2025-08-05 11:50:40,338 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.522724
3     LOCTUPRI   15.659241
2     LOCTUDET   10.141197
11  DATAPRICON    9.940706
10       ANTRI    4.866839
6      CLITRAT    4.507463
9     DTTRIAGE    4.305215
1         MUUH    4.193880
5     PRITRATH    4.122993
8      CLIATEN    4.088073
2025-08-05 11:50:41,421 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:50:44,383 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:50:47,365 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:50:47,825 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 11:50:49,616 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:50:49,616 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:50:49,616 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:50:56,187 - flag1.src.imputation - DEBUG - Training ordinal model with 1122006 samples. Class distribution:
estadiamento_ordinal
0     50786
1    239185
2    295825
3    280275
4    255935
Name: count, dtype: int64
2025-08-05 11:50:56,195 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.418564171228291, 1: 0.938190940067312, 2: 0.7585606355108595, 3: 0.8006465078940327, 4: 0.8767898099126732}
2025-08-05 11:51:22,665 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:51:22,665 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:51:22,666 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:51:22,668 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:51:22,669 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:51:22,673 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236660), 3: np.int64(224220), 4: np.int64(204748), 1: np.int64(191348), 0: np.int64(40628)}
2025-08-05 11:51:22,674 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59165), 3: np.int64(56055), 4: np.int64(51187), 1: np.int64(47837), 0: np.int64(10158)}
2025-08-05 11:51:22,675 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:51:22,676 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.841160
2          T   17.336397
4   LOCTUDET   11.618224
5          M    8.762314
11        pT    6.305995
6   LOCTUPRI    5.511040
1       CNES    4.770652
10         N    3.816251
15  ESTDFIMT    3.693151
7       PTNM    2.960226
2025-08-05 11:51:23,551 - flag1.src.imputation - INFO - Ordinal model - Iter 6 - Val LogLoss: 0.5044 - Accuracy: 0.8502 - Classes: [0 1 2 3 4]
2025-08-05 11:51:23,554 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.841160
2          T   17.336397
4   LOCTUDET   11.618224
5          M    8.762314
11        pT    6.305995
6   LOCTUPRI    5.511040
1       CNES    4.770652
10         N    3.816251
15  ESTDFIMT    3.693151
7       PTNM    2.960226
2025-08-05 11:51:24,737 - root - DEBUG - Processed 50000/644414 samples (7.8%)
2025-08-05 11:51:28,002 - root - DEBUG - Processed 550000/644414 samples (85.3%)
2025-08-05 11:51:42,916 - flag1.src.imputation - INFO - Imputed 644414 MAR values.
2025-08-05 11:51:53,743 - flag1.src.imputation - INFO - Imputed 644414 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:52:04,613 - flag1.src.imputation - INFO - Imputed 644414 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:52:06,140 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:52:06,148 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811546
4     586484
2     488290
3     480088
1     424954
0      85135
99         0
Name: count, dtype: int64
2025-08-05 11:52:07,325 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:52:07,333 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811546
4     600478
3     499763
2     465058
1     412725
0      86927
99         0
Name: count, dtype: int64
2025-08-05 11:52:08,513 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:52:08,522 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811546
4     710088
2     451708
3     429637
1     387685
0      85833
99         0
Name: count, dtype: int64
2025-08-05 11:52:09,320 - flag1.src.imputation - INFO - Completed imputation 6/100 in 211.76 seconds
2025-08-05 11:52:09,320 - flag1.src.imputation - INFO - Estimated time remaining: 55.3 minutes
2025-08-05 11:52:09,320 - root - DEBUG - Imputation 6 completed in 211.76s
2025-08-05 11:52:09,320 - flag1.src.imputation - INFO - Starting imputation 7/100
2025-08-05 11:52:14,073 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:52:14,074 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:52:14,074 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:52:14,074 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:52:14,975 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 11:54:10,163 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:54:10,163 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:54:10,163 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:54:10,168 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:54:10,169 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:54:10,175 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136525), 1: np.int64(321527)}
2025-08-05 11:54:10,177 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284131), 1: np.int64(80382)}
2025-08-05 11:54:10,177 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:54:10,178 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.822496
3     LOCTUPRI   16.161423
11  DATAPRICON   11.486293
2     LOCTUDET    9.684967
6      CLITRAT    4.879920
10       ANTRI    4.433653
8      CLIATEN    4.163105
5     PRITRATH    4.092327
9     DTTRIAGE    3.763111
1         MUUH    3.545379
2025-08-05 11:54:11,533 - flag1.src.imputation - INFO - Binary model - Iter 7 - Val LogLoss: 0.2043 - Accuracy: 0.9357 - Classes: [0 1]
2025-08-05 11:54:11,536 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.822496
3     LOCTUPRI   16.161423
11  DATAPRICON   11.486293
2     LOCTUDET    9.684967
6      CLITRAT    4.879920
10       ANTRI    4.433653
8      CLIATEN    4.163105
5     PRITRATH    4.092327
9     DTTRIAGE    3.763111
1         MUUH    3.545379
2025-08-05 11:54:12,621 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:54:15,596 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:54:18,606 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:54:19,058 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 11:54:20,850 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:54:20,850 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:54:20,882 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:54:27,444 - flag1.src.imputation - DEBUG - Training ordinal model with 1121840 samples. Class distribution:
estadiamento_ordinal
0     51260
1    237672
2    295637
3    281333
4    255938
Name: count, dtype: int64
2025-08-05 11:54:27,452 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.377058134998049, 1: 0.9440236965229392, 2: 0.7589307157087916, 3: 0.7975175326037116, 4: 0.8766498136267378}
2025-08-05 11:54:53,906 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:54:53,906 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:54:53,906 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:54:53,908 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:54:53,909 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:54:53,913 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236510), 3: np.int64(225066), 4: np.int64(204750), 1: np.int64(190138), 0: np.int64(41008)}
2025-08-05 11:54:53,914 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59127), 3: np.int64(56267), 4: np.int64(51188), 1: np.int64(47534), 0: np.int64(10252)}
2025-08-05 11:54:53,915 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:54:53,916 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.441088
2          T   16.995163
4   LOCTUDET   11.353624
5          M    8.785694
11        pT    6.354040
6   LOCTUPRI    5.484036
1       CNES    4.731783
15  ESTDFIMT    3.613723
10         N    3.587112
7       PTNM    2.811059
2025-08-05 11:54:54,786 - flag1.src.imputation - INFO - Ordinal model - Iter 7 - Val LogLoss: 0.5083 - Accuracy: 0.8482 - Classes: [0 1 2 3 4]
2025-08-05 11:54:54,789 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.441088
2          T   16.995163
4   LOCTUDET   11.353624
5          M    8.785694
11        pT    6.354040
6   LOCTUPRI    5.484036
1       CNES    4.731783
15  ESTDFIMT    3.613723
10         N    3.587112
7       PTNM    2.811059
2025-08-05 11:54:55,967 - root - DEBUG - Processed 50000/642152 samples (7.8%)
2025-08-05 11:54:59,285 - root - DEBUG - Processed 550000/642152 samples (85.6%)
2025-08-05 11:55:14,176 - flag1.src.imputation - INFO - Imputed 642152 MAR values.
2025-08-05 11:55:24,940 - flag1.src.imputation - INFO - Imputed 642152 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:55:35,770 - flag1.src.imputation - INFO - Imputed 642152 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:55:37,309 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:55:37,317 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813808
4     576701
2     489751
3     485956
1     423908
0      86373
99         0
Name: count, dtype: int64
2025-08-05 11:55:38,523 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:55:38,531 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813808
4     590953
3     506366
2     467301
1     410547
0      87522
99         0
Name: count, dtype: int64
2025-08-05 11:55:39,706 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:55:39,714 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813808
4     705011
2     456667
3     432881
1     381327
0      86803
99         0
Name: count, dtype: int64
2025-08-05 11:55:40,523 - flag1.src.imputation - INFO - Completed imputation 7/100 in 211.20 seconds
2025-08-05 11:55:40,524 - flag1.src.imputation - INFO - Estimated time remaining: 46.8 minutes
2025-08-05 11:55:40,524 - root - DEBUG - Imputation 7 completed in 211.20s
2025-08-05 11:55:40,524 - flag1.src.imputation - INFO - Starting imputation 8/100
2025-08-05 11:55:45,303 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:55:45,303 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:55:45,303 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:55:45,303 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:55:46,213 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 11:57:41,704 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:57:41,704 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 11:57:41,704 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 11:57:41,709 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 11:57:41,710 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 11:57:41,716 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135978), 1: np.int64(322074)}
2025-08-05 11:57:41,718 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283995), 1: np.int64(80518)}
2025-08-05 11:57:41,718 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 11:57:41,719 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.014460
3     LOCTUPRI   15.724698
11  DATAPRICON   10.569785
2     LOCTUDET    9.870470
6      CLITRAT    4.775217
8      CLIATEN    4.307127
1         MUUH    4.305483
5     PRITRATH    4.276499
10       ANTRI    4.234260
9     DTTRIAGE    4.129196
2025-08-05 11:57:43,077 - flag1.src.imputation - INFO - Binary model - Iter 8 - Val LogLoss: 0.2037 - Accuracy: 0.9363 - Classes: [0 1]
2025-08-05 11:57:43,080 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.014460
3     LOCTUPRI   15.724698
11  DATAPRICON   10.569785
2     LOCTUDET    9.870470
6      CLITRAT    4.775217
8      CLIATEN    4.307127
1         MUUH    4.305483
5     PRITRATH    4.276499
10       ANTRI    4.234260
9     DTTRIAGE    4.129196
2025-08-05 11:57:44,152 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 11:57:47,143 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 11:57:50,170 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 11:57:50,625 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 11:57:52,435 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 11:57:52,435 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:57:52,435 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 11:57:59,016 - flag1.src.imputation - DEBUG - Training ordinal model with 1121179 samples. Class distribution:
estadiamento_ordinal
0     50501
1    238829
2    295231
3    281133
4    255485
Name: count, dtype: int64
2025-08-05 11:57:59,024 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.440224946040672, 1: 0.9388968676333276, 2: 0.7595266079781595, 3: 0.7976146521397346, 4: 0.8776867526469264}
2025-08-05 11:58:25,429 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 11:58:25,430 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 11:58:25,430 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 11:58:25,432 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 11:58:25,433 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 11:58:25,437 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236185), 3: np.int64(224906), 4: np.int64(204388), 1: np.int64(191063), 0: np.int64(40401)}
2025-08-05 11:58:25,438 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59046), 3: np.int64(56227), 4: np.int64(51097), 1: np.int64(47766), 0: np.int64(10100)}
2025-08-05 11:58:25,439 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 11:58:25,440 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.060194
2          T   17.018544
4   LOCTUDET   12.235384
5          M    8.961002
11        pT    6.012463
6   LOCTUPRI    5.102234
1       CNES    4.668646
10         N    3.622628
15  ESTDFIMT    3.579221
7       PTNM    2.954420
2025-08-05 11:58:26,307 - flag1.src.imputation - INFO - Ordinal model - Iter 8 - Val LogLoss: 0.5036 - Accuracy: 0.8489 - Classes: [0 1 2 3 4]
2025-08-05 11:58:26,310 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.060194
2          T   17.018544
4   LOCTUDET   12.235384
5          M    8.961002
11        pT    6.012463
6   LOCTUPRI    5.102234
1       CNES    4.668646
10         N    3.622628
15  ESTDFIMT    3.579221
7       PTNM    2.954420
2025-08-05 11:58:27,491 - root - DEBUG - Processed 50000/643190 samples (7.8%)
2025-08-05 11:58:30,784 - root - DEBUG - Processed 550000/643190 samples (85.5%)
2025-08-05 11:58:45,695 - flag1.src.imputation - INFO - Imputed 643190 MAR values.
2025-08-05 11:58:56,474 - flag1.src.imputation - INFO - Imputed 643190 values for MNAR scenario 'mnar_adv'.
2025-08-05 11:59:07,318 - flag1.src.imputation - INFO - Imputed 643190 values for MNAR scenario 'mnar_s4'.
2025-08-05 11:59:08,855 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:59:08,863 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812770
4     577009
3     487757
2     487600
1     425080
0      86281
99         0
Name: count, dtype: int64
2025-08-05 11:59:10,043 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:59:10,062 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812770
4     591159
3     508659
2     466351
1     411489
0      86069
99         0
Name: count, dtype: int64
2025-08-05 11:59:11,247 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 11:59:11,255 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812770
4     705642
2     449926
3     429116
1     391350
0      87693
99         0
Name: count, dtype: int64
2025-08-05 11:59:12,064 - flag1.src.imputation - INFO - Completed imputation 8/100 in 211.54 seconds
2025-08-05 11:59:12,064 - flag1.src.imputation - INFO - Estimated time remaining: 40.5 minutes
2025-08-05 11:59:12,064 - root - DEBUG - Imputation 8 completed in 211.54s
2025-08-05 11:59:12,064 - flag1.src.imputation - INFO - Starting imputation 9/100
2025-08-05 11:59:16,832 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 11:59:16,832 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 11:59:16,832 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 11:59:16,832 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 11:59:17,738 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:01:13,829 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:01:13,829 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:01:13,830 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:01:13,834 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:01:13,835 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:01:13,841 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136553), 1: np.int64(321499)}
2025-08-05 12:01:13,843 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284138), 1: np.int64(80375)}
2025-08-05 12:01:13,843 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:01:13,844 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.906172
3     LOCTUPRI   15.593947
11  DATAPRICON   11.060378
2     LOCTUDET    9.570374
10       ANTRI    5.022082
6      CLITRAT    4.579576
5     PRITRATH    4.320263
8      CLIATEN    4.262593
9     DTTRIAGE    3.970918
1         MUUH    3.890923
2025-08-05 12:01:15,237 - flag1.src.imputation - INFO - Binary model - Iter 9 - Val LogLoss: 0.2033 - Accuracy: 0.9361 - Classes: [0 1]
2025-08-05 12:01:15,240 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.906172
3     LOCTUPRI   15.593947
11  DATAPRICON   11.060378
2     LOCTUDET    9.570374
10       ANTRI    5.022082
6      CLITRAT    4.579576
5     PRITRATH    4.320263
8      CLIATEN    4.262593
9     DTTRIAGE    3.970918
1         MUUH    3.890923
2025-08-05 12:01:16,328 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:01:19,393 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:01:22,428 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:01:22,882 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 12:01:24,693 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:01:24,693 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:01:24,718 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:01:31,330 - flag1.src.imputation - DEBUG - Training ordinal model with 1121363 samples. Class distribution:
estadiamento_ordinal
0     50732
1    238540
2    294809
3    281344
4    255938
Name: count, dtype: int64
2025-08-05 12:01:31,338 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.420732476543405, 1: 0.9401886476062715, 2: 0.760738647734635, 3: 0.7971472645586897, 4: 0.8762770671021888}
2025-08-05 12:01:57,833 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:01:57,833 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:01:57,833 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:01:57,835 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:01:57,836 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:01:57,840 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235847), 3: np.int64(225075), 4: np.int64(204750), 1: np.int64(190832), 0: np.int64(40586)}
2025-08-05 12:01:57,841 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58962), 3: np.int64(56269), 4: np.int64(51188), 1: np.int64(47708), 0: np.int64(10146)}
2025-08-05 12:01:57,842 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:01:57,843 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.831478
2          T   17.180208
4   LOCTUDET   12.726186
5          M    8.842107
11        pT    6.157156
1       CNES    5.041439
6   LOCTUPRI    4.664631
10         N    3.670876
15  ESTDFIMT    3.529822
7       PTNM    2.871903
2025-08-05 12:01:58,728 - flag1.src.imputation - INFO - Ordinal model - Iter 9 - Val LogLoss: 0.5051 - Accuracy: 0.8490 - Classes: [0 1 2 3 4]
2025-08-05 12:01:58,731 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.831478
2          T   17.180208
4   LOCTUDET   12.726186
5          M    8.842107
11        pT    6.157156
1       CNES    5.041439
6   LOCTUPRI    4.664631
10         N    3.670876
15  ESTDFIMT    3.529822
7       PTNM    2.871903
2025-08-05 12:01:59,909 - root - DEBUG - Processed 50000/643332 samples (7.8%)
2025-08-05 12:02:03,189 - root - DEBUG - Processed 550000/643332 samples (85.5%)
2025-08-05 12:02:18,118 - flag1.src.imputation - INFO - Imputed 643332 MAR values.
2025-08-05 12:02:28,911 - flag1.src.imputation - INFO - Imputed 643332 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:02:39,770 - flag1.src.imputation - INFO - Imputed 643332 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:02:41,291 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:02:41,299 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812628
4     585421
2     485707
3     480202
1     428437
0      84102
99         0
Name: count, dtype: int64
2025-08-05 12:02:42,473 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:02:42,482 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812628
4     599249
3     499367
2     465763
1     416098
0      83392
99         0
Name: count, dtype: int64
2025-08-05 12:02:43,659 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:02:43,667 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812628
4     706343
2     451373
3     432583
1     389415
0      84155
99         0
Name: count, dtype: int64
2025-08-05 12:02:44,469 - flag1.src.imputation - INFO - Completed imputation 9/100 in 212.41 seconds
2025-08-05 12:02:44,469 - flag1.src.imputation - INFO - Estimated time remaining: 35.8 minutes
2025-08-05 12:02:44,469 - root - DEBUG - Imputation 9 completed in 212.41s
2025-08-05 12:02:44,469 - flag1.src.imputation - INFO - Starting imputation 10/100
2025-08-05 12:02:49,228 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:02:49,228 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:02:49,228 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:02:49,228 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:02:50,120 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 12:04:45,363 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:04:45,363 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:04:45,363 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:04:45,368 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:04:45,369 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:04:45,374 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135822), 1: np.int64(322230)}
2025-08-05 12:04:45,376 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283955), 1: np.int64(80558)}
2025-08-05 12:04:45,377 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:04:45,378 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.645872
3     LOCTUPRI   16.760459
11  DATAPRICON   10.572475
2     LOCTUDET    8.969990
10       ANTRI    4.847820
6      CLITRAT    4.838127
5     PRITRATH    4.413519
8      CLIATEN    4.215044
9     DTTRIAGE    4.177846
1         MUUH    3.661571
2025-08-05 12:04:46,749 - flag1.src.imputation - INFO - Binary model - Iter 10 - Val LogLoss: 0.2018 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 12:04:46,752 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.645872
3     LOCTUPRI   16.760459
11  DATAPRICON   10.572475
2     LOCTUDET    8.969990
10       ANTRI    4.847820
6      CLITRAT    4.838127
5     PRITRATH    4.413519
8      CLIATEN    4.215044
9     DTTRIAGE    4.177846
1         MUUH    3.661571
2025-08-05 12:04:47,815 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:04:50,822 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:04:53,828 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:04:54,282 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 12:04:56,070 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:04:56,071 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:04:56,071 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:05:02,575 - flag1.src.imputation - DEBUG - Training ordinal model with 1120973 samples. Class distribution:
estadiamento_ordinal
0     51089
1    238385
2    294681
3    281312
4    255506
Name: count, dtype: int64
2025-08-05 12:05:02,583 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.388314509972792, 1: 0.9404727646454265, 2: 0.7608043952613165, 3: 0.7969606700034125, 4: 0.8774533670442182}
2025-08-05 12:05:29,219 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:05:29,219 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:05:29,219 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:05:29,222 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:05:29,223 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:05:29,229 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235745), 3: np.int64(225049), 4: np.int64(204405), 1: np.int64(190708), 0: np.int64(40871)}
2025-08-05 12:05:29,231 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58936), 3: np.int64(56263), 4: np.int64(51101), 1: np.int64(47677), 0: np.int64(10218)}
2025-08-05 12:05:29,233 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:05:29,234 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.003497
2          T   17.272101
4   LOCTUDET   12.547611
5          M    8.897242
11        pT    6.108629
6   LOCTUPRI    4.746945
1       CNES    4.703406
10         N    3.710773
15  ESTDFIMT    3.481558
3       MUUH    3.102960
2025-08-05 12:05:30,122 - flag1.src.imputation - INFO - Ordinal model - Iter 10 - Val LogLoss: 0.5049 - Accuracy: 0.8491 - Classes: [0 1 2 3 4]
2025-08-05 12:05:30,125 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.003497
2          T   17.272101
4   LOCTUDET   12.547611
5          M    8.897242
11        pT    6.108629
6   LOCTUPRI    4.746945
1       CNES    4.703406
10         N    3.710773
15  ESTDFIMT    3.481558
3       MUUH    3.102960
2025-08-05 12:05:31,313 - root - DEBUG - Processed 50000/644843 samples (7.8%)
2025-08-05 12:05:34,632 - root - DEBUG - Processed 550000/644843 samples (85.3%)
2025-08-05 12:05:49,600 - flag1.src.imputation - INFO - Imputed 644843 MAR values.
2025-08-05 12:06:00,404 - flag1.src.imputation - INFO - Imputed 644843 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:06:11,284 - flag1.src.imputation - INFO - Imputed 644843 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:06:12,806 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:06:12,815 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811117
4     579782
2     489101
3     486978
1     423182
0      86337
99         0
Name: count, dtype: int64
2025-08-05 12:06:13,991 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:06:14,000 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811117
4     592650
3     506208
2     467249
1     410515
0      88758
99         0
Name: count, dtype: int64
2025-08-05 12:06:15,176 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:06:15,185 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811117
4     704850
2     454971
3     432643
1     386604
0      86312
99         0
Name: count, dtype: int64
2025-08-05 12:06:15,985 - flag1.src.imputation - INFO - Completed imputation 10/100 in 211.52 seconds
2025-08-05 12:06:15,985 - flag1.src.imputation - INFO - Estimated time remaining: 31.7 minutes
2025-08-05 12:06:15,985 - root - DEBUG - Imputation 10 completed in 211.52s
2025-08-05 12:06:15,985 - flag1.src.imputation - INFO - Starting imputation 11/100
2025-08-05 12:06:20,723 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:06:20,723 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:06:20,723 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:06:20,723 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:06:21,620 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 12:08:15,843 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:08:15,843 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:08:15,843 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:08:15,848 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:08:15,849 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:08:15,854 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135625), 1: np.int64(322427)}
2025-08-05 12:08:15,856 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283906), 1: np.int64(80607)}
2025-08-05 12:08:15,857 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:08:15,858 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.106036
3     LOCTUPRI   15.364005
11  DATAPRICON   10.248801
2     LOCTUDET    9.831501
10       ANTRI    5.093322
6      CLITRAT    4.500258
5     PRITRATH    4.390607
9     DTTRIAGE    4.196709
8      CLIATEN    4.113990
1         MUUH    3.740746
2025-08-05 12:08:17,208 - flag1.src.imputation - INFO - Binary model - Iter 11 - Val LogLoss: 0.2033 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 12:08:17,211 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.106036
3     LOCTUPRI   15.364005
11  DATAPRICON   10.248801
2     LOCTUDET    9.831501
10       ANTRI    5.093322
6      CLITRAT    4.500258
5     PRITRATH    4.390607
9     DTTRIAGE    4.196709
8      CLIATEN    4.113990
1         MUUH    3.740746
2025-08-05 12:08:18,293 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:08:21,298 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:08:24,318 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:08:24,768 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 12:08:26,555 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:08:26,555 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:08:26,555 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:08:33,052 - flag1.src.imputation - DEBUG - Training ordinal model with 1120176 samples. Class distribution:
estadiamento_ordinal
0     50993
1    238164
2    294982
3    280793
4    255244
Name: count, dtype: int64
2025-08-05 12:08:33,060 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.393450081383719, 1: 0.9406761727213181, 2: 0.759487697554427, 3: 0.7978660436691798, 4: 0.8777295450627635}
2025-08-05 12:08:59,598 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:08:59,598 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:08:59,598 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:08:59,601 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:08:59,602 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:08:59,606 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235986), 3: np.int64(224634), 4: np.int64(204195), 1: np.int64(190531), 0: np.int64(40794)}
2025-08-05 12:08:59,607 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58996), 3: np.int64(56159), 4: np.int64(51049), 1: np.int64(47633), 0: np.int64(10199)}
2025-08-05 12:08:59,608 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:08:59,608 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.467489
2          T   17.088783
4   LOCTUDET   11.348414
5          M    8.853153
11        pT    6.162370
6   LOCTUPRI    5.520417
1       CNES    5.161981
15  ESTDFIMT    3.617832
10         N    3.535458
3       MUUH    2.675106
2025-08-05 12:09:00,490 - flag1.src.imputation - INFO - Ordinal model - Iter 11 - Val LogLoss: 0.5102 - Accuracy: 0.8483 - Classes: [0 1 2 3 4]
2025-08-05 12:09:00,493 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.467489
2          T   17.088783
4   LOCTUDET   11.348414
5          M    8.853153
11        pT    6.162370
6   LOCTUPRI    5.520417
1       CNES    5.161981
15  ESTDFIMT    3.617832
10         N    3.535458
3       MUUH    2.675106
2025-08-05 12:09:01,667 - root - DEBUG - Processed 50000/643654 samples (7.8%)
2025-08-05 12:09:04,957 - root - DEBUG - Processed 550000/643654 samples (85.4%)
2025-08-05 12:09:19,887 - flag1.src.imputation - INFO - Imputed 643654 MAR values.
2025-08-05 12:09:30,672 - flag1.src.imputation - INFO - Imputed 643654 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:09:41,535 - flag1.src.imputation - INFO - Imputed 643654 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:09:43,061 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:09:43,069 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812306
4     577405
2     489315
3     481903
1     426254
0      89314
99         0
Name: count, dtype: int64
2025-08-05 12:09:44,242 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:09:44,251 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812306
4     592524
3     502300
2     467314
1     411939
0      90114
99         0
Name: count, dtype: int64
2025-08-05 12:09:45,424 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:09:45,433 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812306
4     705054
2     453083
3     431582
1     384659
0      89813
99         0
Name: count, dtype: int64
2025-08-05 12:09:46,229 - flag1.src.imputation - INFO - Completed imputation 11/100 in 210.24 seconds
2025-08-05 12:09:46,229 - flag1.src.imputation - INFO - Estimated time remaining: 28.4 minutes
2025-08-05 12:09:46,229 - root - DEBUG - Imputation 11 completed in 210.24s
2025-08-05 12:09:46,229 - flag1.src.imputation - INFO - Starting imputation 12/100
2025-08-05 12:09:50,966 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:09:50,966 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:09:50,966 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:09:50,966 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:09:51,858 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:11:47,112 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:11:47,112 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:11:47,112 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:11:47,117 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:11:47,118 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:11:47,124 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136598), 1: np.int64(321454)}
2025-08-05 12:11:47,125 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284150), 1: np.int64(80363)}
2025-08-05 12:11:47,126 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:11:47,127 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.709054
3     LOCTUPRI   15.924511
11  DATAPRICON   10.130451
2     LOCTUDET    9.657400
6      CLITRAT    4.954362
10       ANTRI    4.746767
8      CLIATEN    4.242880
5     PRITRATH    4.087750
9     DTTRIAGE    3.945326
1         MUUH    3.696160
2025-08-05 12:11:48,461 - flag1.src.imputation - INFO - Binary model - Iter 12 - Val LogLoss: 0.2054 - Accuracy: 0.9361 - Classes: [0 1]
2025-08-05 12:11:48,464 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.709054
3     LOCTUPRI   15.924511
11  DATAPRICON   10.130451
2     LOCTUDET    9.657400
6      CLITRAT    4.954362
10       ANTRI    4.746767
8      CLIATEN    4.242880
5     PRITRATH    4.087750
9     DTTRIAGE    3.945326
1         MUUH    3.696160
2025-08-05 12:11:49,529 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:11:52,492 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:11:55,453 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:11:55,904 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 12:11:57,687 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:11:57,687 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:11:57,714 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:12:04,445 - flag1.src.imputation - DEBUG - Training ordinal model with 1122049 samples. Class distribution:
estadiamento_ordinal
0     51034
1    238277
2    296156
3    280878
4    255704
Name: count, dtype: int64
2025-08-05 12:12:04,453 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.397260649762903, 1: 0.9418021882095209, 2: 0.7577418657734437, 3: 0.7989582665783721, 4: 0.8776155241998561}
2025-08-05 12:12:30,913 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:12:30,913 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:12:30,913 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:12:30,915 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:12:30,916 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:12:30,921 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236925), 3: np.int64(224702), 4: np.int64(204563), 1: np.int64(190622), 0: np.int64(40827)}
2025-08-05 12:12:30,922 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59231), 3: np.int64(56176), 4: np.int64(51141), 1: np.int64(47655), 0: np.int64(10207)}
2025-08-05 12:12:30,923 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:12:30,924 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.258380
2          T   17.200087
4   LOCTUDET   11.626638
5          M    9.077654
11        pT    6.188774
6   LOCTUPRI    5.648286
1       CNES    4.384087
10         N    3.886404
15  ESTDFIMT    3.583709
7       PTNM    2.981692
2025-08-05 12:12:31,822 - flag1.src.imputation - INFO - Ordinal model - Iter 12 - Val LogLoss: 0.5117 - Accuracy: 0.8471 - Classes: [0 1 2 3 4]
2025-08-05 12:12:31,825 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.258380
2          T   17.200087
4   LOCTUDET   11.626638
5          M    9.077654
11        pT    6.188774
6   LOCTUPRI    5.648286
1       CNES    4.384087
10         N    3.886404
15  ESTDFIMT    3.583709
7       PTNM    2.981692
2025-08-05 12:12:33,023 - root - DEBUG - Processed 50000/644353 samples (7.8%)
2025-08-05 12:12:36,410 - root - DEBUG - Processed 550000/644353 samples (85.4%)
2025-08-05 12:12:51,436 - flag1.src.imputation - INFO - Imputed 644353 MAR values.
2025-08-05 12:13:02,242 - flag1.src.imputation - INFO - Imputed 644353 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:13:13,145 - flag1.src.imputation - INFO - Imputed 644353 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:13:14,705 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:13:14,714 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811607
4     578657
2     486730
3     485269
1     427558
0      86676
99         0
Name: count, dtype: int64
2025-08-05 12:13:15,913 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:13:15,921 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811607
4     590316
3     505778
2     467188
1     413170
0      88438
99         0
Name: count, dtype: int64
2025-08-05 12:13:17,111 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:13:17,120 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811607
4     704442
2     449569
3     433055
1     389802
0      88022
99         0
Name: count, dtype: int64
2025-08-05 12:13:17,940 - flag1.src.imputation - INFO - Completed imputation 12/100 in 211.71 seconds
2025-08-05 12:13:17,940 - flag1.src.imputation - INFO - Estimated time remaining: 25.9 minutes
2025-08-05 12:13:17,940 - root - DEBUG - Imputation 12 completed in 211.71s
2025-08-05 12:13:17,940 - flag1.src.imputation - INFO - Starting imputation 13/100
2025-08-05 12:13:22,765 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:13:22,765 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:13:22,765 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:13:22,765 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:13:23,711 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:15:19,163 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:15:19,163 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:15:19,164 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:15:19,168 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:15:19,169 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:15:19,175 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136708), 1: np.int64(321344)}
2025-08-05 12:15:19,177 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284177), 1: np.int64(80336)}
2025-08-05 12:15:19,178 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:15:19,179 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.149675
3     LOCTUPRI   15.271411
11  DATAPRICON   11.016331
2     LOCTUDET   10.165440
6      CLITRAT    4.517040
9     DTTRIAGE    4.333043
5     PRITRATH    4.329432
10       ANTRI    4.310762
8      CLIATEN    4.059614
1         MUUH    3.442124
2025-08-05 12:15:20,581 - flag1.src.imputation - INFO - Binary model - Iter 13 - Val LogLoss: 0.2029 - Accuracy: 0.9366 - Classes: [0 1]
2025-08-05 12:15:20,584 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.149675
3     LOCTUPRI   15.271411
11  DATAPRICON   11.016331
2     LOCTUDET   10.165440
6      CLITRAT    4.517040
9     DTTRIAGE    4.333043
5     PRITRATH    4.329432
10       ANTRI    4.310762
8      CLIATEN    4.059614
1         MUUH    3.442124
2025-08-05 12:15:21,695 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:15:24,778 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:15:27,883 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:15:28,354 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 12:15:30,213 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:15:30,213 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:15:30,213 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:15:36,885 - flag1.src.imputation - DEBUG - Training ordinal model with 1122571 samples. Class distribution:
estadiamento_ordinal
0     50555
1    238796
2    295424
3    281999
4    255797
Name: count, dtype: int64
2025-08-05 12:15:36,893 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.440989021857383, 1: 0.9401924655354361, 2: 0.7599727848786828, 3: 0.7961524686257753, 4: 0.877704586058476}
2025-08-05 12:16:03,582 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:16:03,582 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:16:03,582 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:16:03,585 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:16:03,585 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:16:03,589 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236339), 3: np.int64(225599), 4: np.int64(204637), 1: np.int64(191037), 0: np.int64(40444)}
2025-08-05 12:16:03,590 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59085), 3: np.int64(56400), 4: np.int64(51160), 1: np.int64(47759), 0: np.int64(10111)}
2025-08-05 12:16:03,591 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:16:03,592 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.672229
2          T   17.145440
4   LOCTUDET   12.368330
5          M    9.057658
11        pT    6.310948
6   LOCTUPRI    5.331233
1       CNES    4.777300
10         N    3.846277
15  ESTDFIMT    3.484219
3       MUUH    2.833684
2025-08-05 12:16:04,483 - flag1.src.imputation - INFO - Ordinal model - Iter 13 - Val LogLoss: 0.5036 - Accuracy: 0.8504 - Classes: [0 1 2 3 4]
2025-08-05 12:16:04,486 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.672229
2          T   17.145440
4   LOCTUDET   12.368330
5          M    9.057658
11        pT    6.310948
6   LOCTUPRI    5.331233
1       CNES    4.777300
10         N    3.846277
15  ESTDFIMT    3.484219
3       MUUH    2.833684
2025-08-05 12:16:05,683 - root - DEBUG - Processed 50000/643323 samples (7.8%)
2025-08-05 12:16:09,104 - root - DEBUG - Processed 550000/643323 samples (85.5%)
2025-08-05 12:16:24,126 - flag1.src.imputation - INFO - Imputed 643323 MAR values.
2025-08-05 12:16:34,935 - flag1.src.imputation - INFO - Imputed 643323 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:16:45,820 - flag1.src.imputation - INFO - Imputed 643323 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:16:47,373 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:16:47,381 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812637
4     583078
2     487724
3     481188
1     423548
0      88322
99         0
Name: count, dtype: int64
2025-08-05 12:16:48,566 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:16:48,575 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812637
4     595395
3     501997
2     468658
1     408502
0      89308
99         0
Name: count, dtype: int64
2025-08-05 12:16:49,766 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:16:49,775 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812637
4     704019
2     456733
3     431764
1     384301
0      87043
99         0
Name: count, dtype: int64
2025-08-05 12:16:50,597 - flag1.src.imputation - INFO - Completed imputation 13/100 in 212.66 seconds
2025-08-05 12:16:50,597 - flag1.src.imputation - INFO - Estimated time remaining: 23.7 minutes
2025-08-05 12:16:50,597 - root - DEBUG - Imputation 13 completed in 212.66s
2025-08-05 12:16:50,598 - flag1.src.imputation - INFO - Starting imputation 14/100
2025-08-05 12:16:55,408 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:16:55,408 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:16:55,408 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:16:55,408 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:16:56,352 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:18:50,915 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:18:50,915 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:18:50,915 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:18:50,920 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:18:50,921 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:18:50,927 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136814), 1: np.int64(321238)}
2025-08-05 12:18:50,928 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284203), 1: np.int64(80310)}
2025-08-05 12:18:50,929 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:18:50,930 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.799249
3     LOCTUPRI   16.467551
11  DATAPRICON   10.476042
2     LOCTUDET    9.286079
6      CLITRAT    4.733491
10       ANTRI    4.248704
8      CLIATEN    4.186531
5     PRITRATH    4.168932
9     DTTRIAGE    4.021851
1         MUUH    3.949349
2025-08-05 12:18:52,309 - flag1.src.imputation - INFO - Binary model - Iter 14 - Val LogLoss: 0.2031 - Accuracy: 0.9359 - Classes: [0 1]
2025-08-05 12:18:52,312 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.799249
3     LOCTUPRI   16.467551
11  DATAPRICON   10.476042
2     LOCTUDET    9.286079
6      CLITRAT    4.733491
10       ANTRI    4.248704
8      CLIATEN    4.186531
5     PRITRATH    4.168932
9     DTTRIAGE    4.021851
1         MUUH    3.949349
2025-08-05 12:18:53,405 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:18:56,462 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:18:59,537 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:19:00,001 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 12:19:01,858 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:19:01,858 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:19:01,858 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:19:08,515 - flag1.src.imputation - DEBUG - Training ordinal model with 1121456 samples. Class distribution:
estadiamento_ordinal
0     51228
1    238489
2    295703
3    280938
4    255098
Name: count, dtype: int64
2025-08-05 12:19:08,523 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.378293120949481, 1: 0.9404676945267916, 2: 0.7585016046506122, 3: 0.7983654756565506, 4: 0.8792354310892284}
2025-08-05 12:19:35,192 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:19:35,192 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:19:35,192 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:19:35,195 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:19:35,196 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:19:35,200 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236562), 3: np.int64(224750), 4: np.int64(204078), 1: np.int64(190791), 0: np.int64(40983)}
2025-08-05 12:19:35,201 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59141), 3: np.int64(56188), 4: np.int64(51020), 1: np.int64(47698), 0: np.int64(10245)}
2025-08-05 12:19:35,202 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:19:35,202 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.488661
2          T   16.704754
4   LOCTUDET   12.167341
5          M    8.824608
11        pT    6.012516
6   LOCTUPRI    5.245345
1       CNES    4.801758
15  ESTDFIMT    3.832053
10         N    3.532855
7       PTNM    2.853735
2025-08-05 12:19:36,117 - flag1.src.imputation - INFO - Ordinal model - Iter 14 - Val LogLoss: 0.5110 - Accuracy: 0.8473 - Classes: [0 1 2 3 4]
2025-08-05 12:19:36,121 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.488661
2          T   16.704754
4   LOCTUDET   12.167341
5          M    8.824608
11        pT    6.012516
6   LOCTUPRI    5.245345
1       CNES    4.801758
15  ESTDFIMT    3.832053
10         N    3.532855
7       PTNM    2.853735
2025-08-05 12:19:37,315 - root - DEBUG - Processed 50000/643020 samples (7.8%)
2025-08-05 12:19:40,699 - root - DEBUG - Processed 550000/643020 samples (85.5%)
2025-08-05 12:19:55,725 - flag1.src.imputation - INFO - Imputed 643020 MAR values.
2025-08-05 12:20:06,529 - flag1.src.imputation - INFO - Imputed 643020 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:20:17,394 - flag1.src.imputation - INFO - Imputed 643020 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:20:18,954 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:20:18,962 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812940
4     575911
2     491694
3     485242
1     424875
0      85835
99         0
Name: count, dtype: int64
2025-08-05 12:20:20,143 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:20:20,152 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812940
4     589042
3     508196
2     468176
1     412529
0      85614
99         0
Name: count, dtype: int64
2025-08-05 12:20:21,380 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:20:21,389 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812940
4     701378
2     451416
3     433107
1     391903
0      85753
99         0
Name: count, dtype: int64
2025-08-05 12:20:22,208 - flag1.src.imputation - INFO - Completed imputation 14/100 in 211.61 seconds
2025-08-05 12:20:22,208 - flag1.src.imputation - INFO - Estimated time remaining: 21.7 minutes
2025-08-05 12:20:22,208 - root - DEBUG - Imputation 14 completed in 211.61s
2025-08-05 12:20:22,208 - flag1.src.imputation - INFO - Starting imputation 15/100
2025-08-05 12:20:27,014 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:20:27,014 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:20:27,014 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:20:27,014 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:20:27,963 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:22:24,014 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:22:24,014 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:22:24,014 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:22:24,019 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:22:24,020 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:22:24,026 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1137072), 1: np.int64(320980)}
2025-08-05 12:22:24,028 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284268), 1: np.int64(80245)}
2025-08-05 12:22:24,028 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:22:24,029 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.492737
3     LOCTUPRI   15.555201
11  DATAPRICON   11.027805
2     LOCTUDET    9.690848
6      CLITRAT    5.155041
9     DTTRIAGE    4.540057
10       ANTRI    4.511281
5     PRITRATH    4.305755
1         MUUH    4.023103
8      CLIATEN    3.893576
2025-08-05 12:22:25,432 - flag1.src.imputation - INFO - Binary model - Iter 15 - Val LogLoss: 0.2039 - Accuracy: 0.9363 - Classes: [0 1]
2025-08-05 12:22:25,435 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.492737
3     LOCTUPRI   15.555201
11  DATAPRICON   11.027805
2     LOCTUDET    9.690848
6      CLITRAT    5.155041
9     DTTRIAGE    4.540057
10       ANTRI    4.511281
5     PRITRATH    4.305755
1         MUUH    4.023103
8      CLIATEN    3.893576
2025-08-05 12:22:26,547 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:22:29,667 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:22:32,760 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:22:33,228 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 12:22:35,092 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:22:35,092 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:22:35,092 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:22:41,778 - flag1.src.imputation - DEBUG - Training ordinal model with 1121927 samples. Class distribution:
estadiamento_ordinal
0     51105
1    238635
2    295238
3    281293
4    255656
Name: count, dtype: int64
2025-08-05 12:22:41,786 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.390674102338323, 1: 0.9402870492593292, 2: 0.760015309682358, 3: 0.7976927971901185, 4: 0.8776848577776387}
2025-08-05 12:23:08,354 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:23:08,354 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:23:08,354 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:23:08,357 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:23:08,358 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:23:08,362 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236190), 3: np.int64(225034), 4: np.int64(204525), 1: np.int64(190908), 0: np.int64(40884)}
2025-08-05 12:23:08,363 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59048), 3: np.int64(56259), 4: np.int64(51131), 1: np.int64(47727), 0: np.int64(10221)}
2025-08-05 12:23:08,364 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:23:08,365 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.549490
2          T   17.719446
4   LOCTUDET   11.825598
5          M    8.913077
11        pT    6.314528
6   LOCTUPRI    5.278737
1       CNES    4.690294
10         N    3.526128
15  ESTDFIMT    3.470440
7       PTNM    2.842236
2025-08-05 12:23:09,271 - flag1.src.imputation - INFO - Ordinal model - Iter 15 - Val LogLoss: 0.5112 - Accuracy: 0.8471 - Classes: [0 1 2 3 4]
2025-08-05 12:23:09,274 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.549490
2          T   17.719446
4   LOCTUDET   11.825598
5          M    8.913077
11        pT    6.314528
6   LOCTUPRI    5.278737
1       CNES    4.690294
10         N    3.526128
15  ESTDFIMT    3.470440
7       PTNM    2.842236
2025-08-05 12:23:10,476 - root - DEBUG - Processed 50000/643101 samples (7.8%)
2025-08-05 12:23:13,872 - root - DEBUG - Processed 550000/643101 samples (85.5%)
2025-08-05 12:23:28,877 - flag1.src.imputation - INFO - Imputed 643101 MAR values.
2025-08-05 12:23:39,673 - flag1.src.imputation - INFO - Imputed 643101 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:23:50,613 - flag1.src.imputation - INFO - Imputed 643101 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:23:52,174 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:23:52,182 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812859
4     586066
2     487120
3     479180
1     424896
0      86376
99         0
Name: count, dtype: int64
2025-08-05 12:23:53,367 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:23:53,376 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812859
4     598678
3     500091
2     469317
1     408308
0      87244
99         0
Name: count, dtype: int64
2025-08-05 12:23:54,603 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:23:54,612 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812859
4     712965
2     455553
3     430679
1     380459
0      83982
99         0
Name: count, dtype: int64
2025-08-05 12:23:55,434 - flag1.src.imputation - INFO - Completed imputation 15/100 in 213.23 seconds
2025-08-05 12:23:55,434 - flag1.src.imputation - INFO - Estimated time remaining: 20.1 minutes
2025-08-05 12:23:55,434 - root - DEBUG - Imputation 15 completed in 213.23s
2025-08-05 12:23:55,434 - flag1.src.imputation - INFO - Starting imputation 16/100
2025-08-05 12:24:00,254 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:24:00,255 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:24:00,255 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:24:00,255 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:24:01,196 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 12:25:57,072 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:25:57,072 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:25:57,072 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:25:57,077 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:25:57,078 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:25:57,084 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135828), 1: np.int64(322224)}
2025-08-05 12:25:57,086 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283957), 1: np.int64(80556)}
2025-08-05 12:25:57,087 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:25:57,087 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.091571
3     LOCTUPRI   15.942232
11  DATAPRICON   10.495470
2     LOCTUDET   10.058474
10       ANTRI    4.755402
9     DTTRIAGE    4.653915
5     PRITRATH    4.090973
6      CLITRAT    4.084804
8      CLIATEN    4.059993
1         MUUH    3.904072
2025-08-05 12:25:58,481 - flag1.src.imputation - INFO - Binary model - Iter 16 - Val LogLoss: 0.2043 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 12:25:58,483 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.091571
3     LOCTUPRI   15.942232
11  DATAPRICON   10.495470
2     LOCTUDET   10.058474
10       ANTRI    4.755402
9     DTTRIAGE    4.653915
5     PRITRATH    4.090973
6      CLITRAT    4.084804
8      CLIATEN    4.059993
1         MUUH    3.904072
2025-08-05 12:25:59,593 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:26:02,668 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:26:05,773 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:26:06,239 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 12:26:08,093 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:26:08,093 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:26:08,093 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:26:14,768 - flag1.src.imputation - DEBUG - Training ordinal model with 1121486 samples. Class distribution:
estadiamento_ordinal
0     50926
1    239411
2    295487
3    280446
4    255216
Name: count, dtype: int64
2025-08-05 12:26:14,776 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.404374975454581, 1: 0.9368709040102585, 2: 0.7590763722261893, 3: 0.7997874813689623, 4: 0.8788524230455771}
2025-08-05 12:26:41,314 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:26:41,314 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:26:41,314 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:26:41,317 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:26:41,317 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:26:41,321 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236389), 3: np.int64(224356), 4: np.int64(204173), 1: np.int64(191529), 0: np.int64(40741)}
2025-08-05 12:26:41,322 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59098), 3: np.int64(56090), 4: np.int64(51043), 1: np.int64(47882), 0: np.int64(10185)}
2025-08-05 12:26:41,323 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:26:41,324 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.955556
2          T   17.089053
4   LOCTUDET   10.981344
5          M    9.242903
6   LOCTUPRI    6.324329
11        pT    6.201442
1       CNES    4.751687
15  ESTDFIMT    3.468020
10         N    3.111354
7       PTNM    2.672482
2025-08-05 12:26:42,221 - flag1.src.imputation - INFO - Ordinal model - Iter 16 - Val LogLoss: 0.5116 - Accuracy: 0.8477 - Classes: [0 1 2 3 4]
2025-08-05 12:26:42,224 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.955556
2          T   17.089053
4   LOCTUDET   10.981344
5          M    9.242903
6   LOCTUPRI    6.324329
11        pT    6.201442
1       CNES    4.751687
15  ESTDFIMT    3.468020
10         N    3.111354
7       PTNM    2.672482
2025-08-05 12:26:43,421 - root - DEBUG - Processed 50000/644925 samples (7.8%)
2025-08-05 12:26:46,818 - root - DEBUG - Processed 550000/644925 samples (85.3%)
2025-08-05 12:27:01,863 - flag1.src.imputation - INFO - Imputed 644925 MAR values.
2025-08-05 12:27:12,698 - flag1.src.imputation - INFO - Imputed 644925 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:27:23,589 - flag1.src.imputation - INFO - Imputed 644925 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:27:25,154 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:27:25,163 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811035
4     584388
2     486714
3     482337
1     426692
0      85331
99         0
Name: count, dtype: int64
2025-08-05 12:27:26,358 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:27:26,367 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811035
4     596932
3     502045
2     467801
1     413005
0      85679
99         0
Name: count, dtype: int64
2025-08-05 12:27:27,579 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:27:27,587 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811035
4     709711
2     452652
3     430939
1     388809
0      83351
99         0
Name: count, dtype: int64
2025-08-05 12:27:28,407 - flag1.src.imputation - INFO - Completed imputation 16/100 in 212.97 seconds
2025-08-05 12:27:28,407 - flag1.src.imputation - INFO - Estimated time remaining: 18.6 minutes
2025-08-05 12:27:28,408 - root - DEBUG - Imputation 16 completed in 212.97s
2025-08-05 12:27:28,408 - flag1.src.imputation - INFO - Starting imputation 17/100
2025-08-05 12:27:33,234 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:27:33,234 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:27:33,234 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:27:33,234 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:27:34,182 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:29:29,354 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:29:29,354 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:29:29,354 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:29:29,359 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:29:29,360 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:29:29,366 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136584), 1: np.int64(321468)}
2025-08-05 12:29:29,368 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284146), 1: np.int64(80367)}
2025-08-05 12:29:29,369 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:29:29,369 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.564438
3     LOCTUPRI   15.414167
11  DATAPRICON   10.539031
2     LOCTUDET    9.781497
6      CLITRAT    4.888866
9     DTTRIAGE    4.535067
10       ANTRI    4.479143
5     PRITRATH    4.366897
8      CLIATEN    4.287722
1         MUUH    3.958889
2025-08-05 12:29:30,746 - flag1.src.imputation - INFO - Binary model - Iter 17 - Val LogLoss: 0.2020 - Accuracy: 0.9364 - Classes: [0 1]
2025-08-05 12:29:30,749 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.564438
3     LOCTUPRI   15.414167
11  DATAPRICON   10.539031
2     LOCTUDET    9.781497
6      CLITRAT    4.888866
9     DTTRIAGE    4.535067
10       ANTRI    4.479143
5     PRITRATH    4.366897
8      CLIATEN    4.287722
1         MUUH    3.958889
2025-08-05 12:29:31,858 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:29:34,935 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:29:38,062 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:29:38,542 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 12:29:40,389 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:29:40,389 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:29:40,389 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:29:47,060 - flag1.src.imputation - DEBUG - Training ordinal model with 1120880 samples. Class distribution:
estadiamento_ordinal
0     51208
1    238071
2    295659
3    280634
4    255308
Name: count, dtype: int64
2025-08-05 12:29:47,069 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.377753476019372, 1: 0.9416350584489501, 2: 0.7582248468675061, 3: 0.7988198151328777, 4: 0.878061008664045}
2025-08-05 12:30:13,679 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:30:13,679 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:30:13,680 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:30:13,682 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:30:13,683 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:30:13,687 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236527), 3: np.int64(224507), 4: np.int64(204246), 1: np.int64(190457), 0: np.int64(40967)}
2025-08-05 12:30:13,688 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59132), 3: np.int64(56127), 4: np.int64(51062), 1: np.int64(47614), 0: np.int64(10241)}
2025-08-05 12:30:13,689 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:30:13,690 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.204160
2          T   17.535870
4   LOCTUDET   10.999706
5          M    8.793579
6   LOCTUPRI    6.041912
11        pT    5.995081
1       CNES    4.828584
10         N    3.720800
15  ESTDFIMT    3.591492
7       PTNM    2.863519
2025-08-05 12:30:14,584 - flag1.src.imputation - INFO - Ordinal model - Iter 17 - Val LogLoss: 0.5143 - Accuracy: 0.8467 - Classes: [0 1 2 3 4]
2025-08-05 12:30:14,587 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.204160
2          T   17.535870
4   LOCTUDET   10.999706
5          M    8.793579
6   LOCTUPRI    6.041912
11        pT    5.995081
1       CNES    4.828584
10         N    3.720800
15  ESTDFIMT    3.591492
7       PTNM    2.863519
2025-08-05 12:30:15,779 - root - DEBUG - Processed 50000/642160 samples (7.8%)
2025-08-05 12:30:19,197 - root - DEBUG - Processed 550000/642160 samples (85.6%)
2025-08-05 12:30:34,199 - flag1.src.imputation - INFO - Imputed 642160 MAR values.
2025-08-05 12:30:44,994 - flag1.src.imputation - INFO - Imputed 642160 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:30:55,846 - flag1.src.imputation - INFO - Imputed 642160 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:30:57,409 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:30:57,418 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813800
4     578347
2     487707
3     485555
1     424657
0      86431
99         0
Name: count, dtype: int64
2025-08-05 12:30:58,606 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:30:58,614 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813800
4     591506
3     505118
2     465478
1     413796
0      86799
99         0
Name: count, dtype: int64
2025-08-05 12:30:59,815 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:30:59,823 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813800
4     704775
2     450792
3     431469
1     389044
0      86617
99         0
Name: count, dtype: int64
2025-08-05 12:31:00,645 - flag1.src.imputation - INFO - Completed imputation 17/100 in 212.24 seconds
2025-08-05 12:31:00,645 - flag1.src.imputation - INFO - Estimated time remaining: 17.3 minutes
2025-08-05 12:31:00,645 - root - DEBUG - Imputation 17 completed in 212.24s
2025-08-05 12:31:00,645 - flag1.src.imputation - INFO - Starting imputation 18/100
2025-08-05 12:31:05,477 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:31:05,477 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:31:05,477 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:31:05,477 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:31:06,421 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 12:33:01,706 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:33:01,706 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:33:01,706 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:33:01,711 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:33:01,712 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:33:01,717 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135911), 1: np.int64(322141)}
2025-08-05 12:33:01,719 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283978), 1: np.int64(80535)}
2025-08-05 12:33:01,720 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:33:01,721 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.011248
3     LOCTUPRI   16.064388
11  DATAPRICON   10.533511
2     LOCTUDET    9.559307
6      CLITRAT    4.744722
10       ANTRI    4.582155
9     DTTRIAGE    4.245322
5     PRITRATH    4.215806
8      CLIATEN    4.165578
1         MUUH    4.030331
2025-08-05 12:33:03,117 - flag1.src.imputation - INFO - Binary model - Iter 18 - Val LogLoss: 0.2058 - Accuracy: 0.9356 - Classes: [0 1]
2025-08-05 12:33:03,120 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.011248
3     LOCTUPRI   16.064388
11  DATAPRICON   10.533511
2     LOCTUDET    9.559307
6      CLITRAT    4.744722
10       ANTRI    4.582155
9     DTTRIAGE    4.245322
5     PRITRATH    4.215806
8      CLIATEN    4.165578
1         MUUH    4.030331
2025-08-05 12:33:04,231 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:33:07,337 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:33:10,431 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:33:10,900 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 12:33:12,760 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:33:12,760 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:33:12,789 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:33:19,480 - flag1.src.imputation - DEBUG - Training ordinal model with 1120164 samples. Class distribution:
estadiamento_ordinal
0     50682
1    237949
2    295742
3    280254
4    255537
Name: count, dtype: int64
2025-08-05 12:33:19,488 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.420362258790103, 1: 0.9415160391512467, 2: 0.7575278452164387, 3: 0.7993919801323085, 4: 0.8767137439979338}
2025-08-05 12:33:46,062 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:33:46,062 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:33:46,062 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:33:46,065 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:33:46,065 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:33:46,069 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236593), 3: np.int64(224203), 4: np.int64(204430), 1: np.int64(190359), 0: np.int64(40546)}
2025-08-05 12:33:46,071 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59149), 3: np.int64(56051), 4: np.int64(51107), 1: np.int64(47590), 0: np.int64(10136)}
2025-08-05 12:33:46,071 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:33:46,072 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.055369
2          T   17.286380
4   LOCTUDET   11.865566
5          M    8.682908
11        pT    6.204708
6   LOCTUPRI    5.375845
1       CNES    4.873698
10         N    3.773331
15  ESTDFIMT    3.531549
3       MUUH    2.722896
2025-08-05 12:33:46,966 - flag1.src.imputation - INFO - Ordinal model - Iter 18 - Val LogLoss: 0.5045 - Accuracy: 0.8500 - Classes: [0 1 2 3 4]
2025-08-05 12:33:46,969 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.055369
2          T   17.286380
4   LOCTUDET   11.865566
5          M    8.682908
11        pT    6.204708
6   LOCTUPRI    5.375845
1       CNES    4.873698
10         N    3.773331
15  ESTDFIMT    3.531549
3       MUUH    2.722896
2025-08-05 12:33:48,161 - root - DEBUG - Processed 50000/642973 samples (7.8%)
2025-08-05 12:33:51,554 - root - DEBUG - Processed 550000/642973 samples (85.5%)
2025-08-05 12:34:06,558 - flag1.src.imputation - INFO - Imputed 642973 MAR values.
2025-08-05 12:34:17,343 - flag1.src.imputation - INFO - Imputed 642973 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:34:28,189 - flag1.src.imputation - INFO - Imputed 642973 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:34:29,737 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:34:29,746 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812987
4     580343
2     489585
3     484482
1     422709
0      86391
99         0
Name: count, dtype: int64
2025-08-05 12:34:30,946 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:34:30,955 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812987
4     593378
3     503856
2     469243
1     410477
0      86556
99         0
Name: count, dtype: int64
2025-08-05 12:34:32,150 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:34:32,158 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812987
4     707647
2     449671
3     429801
1     388586
0      87805
99         0
Name: count, dtype: int64
2025-08-05 12:34:32,971 - flag1.src.imputation - INFO - Completed imputation 18/100 in 212.33 seconds
2025-08-05 12:34:32,971 - flag1.src.imputation - INFO - Estimated time remaining: 16.1 minutes
2025-08-05 12:34:32,971 - root - DEBUG - Imputation 18 completed in 212.33s
2025-08-05 12:34:32,971 - flag1.src.imputation - INFO - Starting imputation 19/100
2025-08-05 12:34:37,770 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:34:37,770 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:34:37,770 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:34:37,770 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:34:38,708 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:36:33,728 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:36:33,728 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:36:33,728 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:36:33,733 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:36:33,734 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:36:33,740 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136729), 1: np.int64(321323)}
2025-08-05 12:36:33,742 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284182), 1: np.int64(80331)}
2025-08-05 12:36:33,742 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:36:33,743 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.150488
3     LOCTUPRI   15.457600
11  DATAPRICON   11.056600
2     LOCTUDET    9.562428
6      CLITRAT    4.946270
9     DTTRIAGE    4.372558
5     PRITRATH    4.330907
8      CLIATEN    4.269051
10       ANTRI    4.138158
1         MUUH    4.070101
2025-08-05 12:36:35,111 - flag1.src.imputation - INFO - Binary model - Iter 19 - Val LogLoss: 0.2029 - Accuracy: 0.9359 - Classes: [0 1]
2025-08-05 12:36:35,114 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.150488
3     LOCTUPRI   15.457600
11  DATAPRICON   11.056600
2     LOCTUDET    9.562428
6      CLITRAT    4.946270
9     DTTRIAGE    4.372558
5     PRITRATH    4.330907
8      CLIATEN    4.269051
10       ANTRI    4.138158
1         MUUH    4.070101
2025-08-05 12:36:36,215 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:36:39,270 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:36:42,320 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:36:42,787 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 12:36:44,627 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:36:44,627 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:36:44,627 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:36:51,278 - flag1.src.imputation - DEBUG - Training ordinal model with 1121778 samples. Class distribution:
estadiamento_ordinal
0     50884
1    238463
2    294873
3    281098
4    256460
Name: count, dtype: int64
2025-08-05 12:36:51,286 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.409158085056206, 1: 0.9408402980755924, 2: 0.7608550121577764, 3: 0.7981401504101773, 4: 0.8748171254776573}
2025-08-05 12:37:18,027 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:37:18,027 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:37:18,028 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:37:18,030 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:37:18,031 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:37:18,035 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235898), 3: np.int64(224878), 4: np.int64(205168), 1: np.int64(190771), 0: np.int64(40707)}
2025-08-05 12:37:18,036 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58975), 3: np.int64(56220), 4: np.int64(51292), 1: np.int64(47692), 0: np.int64(10177)}
2025-08-05 12:37:18,037 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:37:18,038 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.028642
2          T   17.304796
4   LOCTUDET   11.755163
5          M    9.004484
11        pT    6.341398
6   LOCTUPRI    5.404507
1       CNES    4.792062
15  ESTDFIMT    3.624648
10         N    3.289776
3       MUUH    2.560469
2025-08-05 12:37:18,934 - flag1.src.imputation - INFO - Ordinal model - Iter 19 - Val LogLoss: 0.5057 - Accuracy: 0.8489 - Classes: [0 1 2 3 4]
2025-08-05 12:37:18,937 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.028642
2          T   17.304796
4   LOCTUDET   11.755163
5          M    9.004484
11        pT    6.341398
6   LOCTUPRI    5.404507
1       CNES    4.792062
15  ESTDFIMT    3.624648
10         N    3.289776
3       MUUH    2.560469
2025-08-05 12:37:20,133 - root - DEBUG - Processed 50000/641520 samples (7.8%)
2025-08-05 12:37:23,527 - root - DEBUG - Processed 550000/641520 samples (85.7%)
2025-08-05 12:37:38,536 - flag1.src.imputation - INFO - Imputed 641520 MAR values.
2025-08-05 12:37:49,315 - flag1.src.imputation - INFO - Imputed 641520 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:38:00,171 - flag1.src.imputation - INFO - Imputed 641520 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:38:01,730 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:38:01,738 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814440
4     581023
2     489195
3     483104
1     420817
0      87918
99         0
Name: count, dtype: int64
2025-08-05 12:38:02,935 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:38:02,943 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814440
4     594078
3     500902
2     467105
1     411851
0      88121
99         0
Name: count, dtype: int64
2025-08-05 12:38:04,128 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:38:04,136 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814440
4     701636
2     450611
3     432598
1     389947
0      87265
99         0
Name: count, dtype: int64
2025-08-05 12:38:04,956 - flag1.src.imputation - INFO - Completed imputation 19/100 in 211.99 seconds
2025-08-05 12:38:04,956 - flag1.src.imputation - INFO - Estimated time remaining: 15.1 minutes
2025-08-05 12:38:04,956 - root - DEBUG - Imputation 19 completed in 211.99s
2025-08-05 12:38:04,956 - flag1.src.imputation - INFO - Starting imputation 20/100
2025-08-05 12:38:09,785 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:38:09,785 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:38:09,785 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:38:09,785 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:38:10,723 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:40:05,945 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:40:05,945 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:40:05,946 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:40:05,950 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:40:05,951 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:40:05,957 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1137224), 1: np.int64(320828)}
2025-08-05 12:40:05,959 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284306), 1: np.int64(80207)}
2025-08-05 12:40:05,960 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:40:05,961 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.709813
3     LOCTUPRI   16.068827
11  DATAPRICON   11.217440
2     LOCTUDET    9.307218
6      CLITRAT    4.795928
10       ANTRI    4.586706
9     DTTRIAGE    4.075347
5     PRITRATH    4.041560
8      CLIATEN    3.980650
1         MUUH    3.875256
2025-08-05 12:40:07,411 - flag1.src.imputation - INFO - Binary model - Iter 20 - Val LogLoss: 0.2055 - Accuracy: 0.9357 - Classes: [0 1]
2025-08-05 12:40:07,414 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.709813
3     LOCTUPRI   16.068827
11  DATAPRICON   11.217440
2     LOCTUDET    9.307218
6      CLITRAT    4.795928
10       ANTRI    4.586706
9     DTTRIAGE    4.075347
5     PRITRATH    4.041560
8      CLIATEN    3.980650
1         MUUH    3.875256
2025-08-05 12:40:08,799 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:40:11,947 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:40:15,055 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:40:15,523 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 12:40:17,379 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:40:17,379 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:40:17,379 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:40:24,172 - flag1.src.imputation - DEBUG - Training ordinal model with 1121435 samples. Class distribution:
estadiamento_ordinal
0     50977
1    238200
2    295076
3    281550
4    255632
Name: count, dtype: int64
2025-08-05 12:40:24,180 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.399768523059419, 1: 0.941591099916037, 2: 0.7600990931149941, 3: 0.7966151660451074, 4: 0.8773823308505977}
2025-08-05 12:40:50,835 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:40:50,836 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:40:50,836 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:40:50,838 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:40:50,839 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:40:50,843 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236061), 3: np.int64(225240), 4: np.int64(204506), 1: np.int64(190560), 0: np.int64(40781)}
2025-08-05 12:40:50,844 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59015), 3: np.int64(56310), 4: np.int64(51126), 1: np.int64(47640), 0: np.int64(10196)}
2025-08-05 12:40:50,845 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:40:50,846 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.274998
2          T   17.071037
4   LOCTUDET   10.773997
5          M    9.019504
6   LOCTUPRI    6.504479
11        pT    6.338135
1       CNES    4.740218
15  ESTDFIMT    3.644351
10         N    3.629757
7       PTNM    2.853213
2025-08-05 12:40:51,763 - flag1.src.imputation - INFO - Ordinal model - Iter 20 - Val LogLoss: 0.5156 - Accuracy: 0.8460 - Classes: [0 1 2 3 4]
2025-08-05 12:40:51,766 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.274998
2          T   17.071037
4   LOCTUDET   10.773997
5          M    9.019504
6   LOCTUPRI    6.504479
11        pT    6.338135
1       CNES    4.740218
15  ESTDFIMT    3.644351
10         N    3.629757
7       PTNM    2.853213
2025-08-05 12:40:52,965 - root - DEBUG - Processed 50000/644564 samples (7.8%)
2025-08-05 12:40:56,388 - root - DEBUG - Processed 550000/644564 samples (85.3%)
2025-08-05 12:41:11,442 - flag1.src.imputation - INFO - Imputed 644564 MAR values.
2025-08-05 12:41:22,265 - flag1.src.imputation - INFO - Imputed 644564 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:41:33,163 - flag1.src.imputation - INFO - Imputed 644564 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:41:34,717 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:41:34,725 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811396
4     589329
2     487771
3     480954
1     421299
0      85748
99         0
Name: count, dtype: int64
2025-08-05 12:41:35,915 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:41:35,924 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811396
4     597236
3     504074
2     467149
1     408769
0      87873
99         0
Name: count, dtype: int64
2025-08-05 12:41:37,210 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:41:37,219 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811396
4     712624
2     451607
3     431137
1     383721
0      86012
99         0
Name: count, dtype: int64
2025-08-05 12:41:38,037 - flag1.src.imputation - INFO - Completed imputation 20/100 in 213.08 seconds
2025-08-05 12:41:38,037 - flag1.src.imputation - INFO - Estimated time remaining: 14.2 minutes
2025-08-05 12:41:38,037 - root - DEBUG - Imputation 20 completed in 213.08s
2025-08-05 12:41:38,037 - flag1.src.imputation - INFO - Starting imputation 21/100
2025-08-05 12:41:42,855 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:41:42,855 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:41:42,855 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:41:42,855 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:41:43,789 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 12:43:38,378 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:43:38,378 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:43:38,378 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:43:38,383 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:43:38,384 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:43:38,390 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136140), 1: np.int64(321912)}
2025-08-05 12:43:38,392 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284035), 1: np.int64(80478)}
2025-08-05 12:43:38,393 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:43:38,394 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.850139
3     LOCTUPRI   15.474644
11  DATAPRICON   10.682425
2     LOCTUDET    9.658485
6      CLITRAT    4.846817
10       ANTRI    4.281152
8      CLIATEN    4.215103
9     DTTRIAGE    4.147010
1         MUUH    4.146369
5     PRITRATH    4.092597
2025-08-05 12:43:39,781 - flag1.src.imputation - INFO - Binary model - Iter 21 - Val LogLoss: 0.2019 - Accuracy: 0.9363 - Classes: [0 1]
2025-08-05 12:43:39,784 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.850139
3     LOCTUPRI   15.474644
11  DATAPRICON   10.682425
2     LOCTUDET    9.658485
6      CLITRAT    4.846817
10       ANTRI    4.281152
8      CLIATEN    4.215103
9     DTTRIAGE    4.147010
1         MUUH    4.146369
5     PRITRATH    4.092597
2025-08-05 12:43:41,100 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:43:44,238 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:43:47,304 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:43:47,770 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 12:43:49,622 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:43:49,622 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:43:49,622 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:43:56,295 - flag1.src.imputation - DEBUG - Training ordinal model with 1122453 samples. Class distribution:
estadiamento_ordinal
0     50822
1    238170
2    295562
3    281598
4    256301
Name: count, dtype: int64
2025-08-05 12:43:56,305 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.4171933414662945, 1: 0.9425645547298148, 2: 0.7595381002970611, 3: 0.7972023949033729, 4: 0.8758865552611967}
2025-08-05 12:44:22,932 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:44:22,932 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:44:22,932 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:44:22,935 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:44:22,936 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:44:22,940 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236449), 3: np.int64(225278), 4: np.int64(205041), 1: np.int64(190536), 0: np.int64(40658)}
2025-08-05 12:44:22,941 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59113), 3: np.int64(56320), 4: np.int64(51260), 1: np.int64(47634), 0: np.int64(10164)}
2025-08-05 12:44:22,942 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:44:22,943 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.834148
2          T   16.938629
4   LOCTUDET   10.409193
5          M    8.804057
6   LOCTUPRI    6.452311
11        pT    6.341336
1       CNES    5.114611
10         N    3.740492
15  ESTDFIMT    3.561529
3       MUUH    2.887135
2025-08-05 12:44:23,846 - flag1.src.imputation - INFO - Ordinal model - Iter 21 - Val LogLoss: 0.5073 - Accuracy: 0.8480 - Classes: [0 1 2 3 4]
2025-08-05 12:44:23,849 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.834148
2          T   16.938629
4   LOCTUDET   10.409193
5          M    8.804057
6   LOCTUPRI    6.452311
11        pT    6.341336
1       CNES    5.114611
10         N    3.740492
15  ESTDFIMT    3.561529
3       MUUH    2.887135
2025-08-05 12:44:25,062 - root - DEBUG - Processed 50000/641510 samples (7.8%)
2025-08-05 12:44:28,507 - root - DEBUG - Processed 550000/641510 samples (85.7%)
2025-08-05 12:44:43,584 - flag1.src.imputation - INFO - Imputed 641510 MAR values.
2025-08-05 12:44:54,331 - flag1.src.imputation - INFO - Imputed 641510 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:45:05,196 - flag1.src.imputation - INFO - Imputed 641510 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:45:06,755 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:45:06,763 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814450
4     574497
3     488302
2     487924
1     425389
0      85935
99         0
Name: count, dtype: int64
2025-08-05 12:45:07,957 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:45:07,965 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814450
4     586451
3     511020
2     466279
1     411569
0      86728
99         0
Name: count, dtype: int64
2025-08-05 12:45:09,154 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:45:09,162 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814450
4     703901
2     452910
3     433962
1     384435
0      86839
99         0
Name: count, dtype: int64
2025-08-05 12:45:09,997 - flag1.src.imputation - INFO - Completed imputation 21/100 in 211.96 seconds
2025-08-05 12:45:09,998 - flag1.src.imputation - INFO - Estimated time remaining: 13.3 minutes
2025-08-05 12:45:09,998 - root - DEBUG - Imputation 21 completed in 211.96s
2025-08-05 12:45:09,998 - flag1.src.imputation - INFO - Starting imputation 22/100
2025-08-05 12:45:14,824 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:45:14,824 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:45:14,824 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:45:14,824 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:45:15,758 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 12:47:10,642 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:47:10,642 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:47:10,643 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:47:10,648 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:47:10,649 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:47:10,654 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136394), 1: np.int64(321658)}
2025-08-05 12:47:10,656 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284098), 1: np.int64(80415)}
2025-08-05 12:47:10,657 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:47:10,658 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.837500
3     LOCTUPRI   15.677498
11  DATAPRICON   10.987958
2     LOCTUDET    9.504447
9     DTTRIAGE    4.743753
6      CLITRAT    4.489757
8      CLIATEN    4.414703
10       ANTRI    4.291958
1         MUUH    3.971081
5     PRITRATH    3.842352
2025-08-05 12:47:12,051 - flag1.src.imputation - INFO - Binary model - Iter 22 - Val LogLoss: 0.2055 - Accuracy: 0.9360 - Classes: [0 1]
2025-08-05 12:47:12,054 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.837500
3     LOCTUPRI   15.677498
11  DATAPRICON   10.987958
2     LOCTUDET    9.504447
9     DTTRIAGE    4.743753
6      CLITRAT    4.489757
8      CLIATEN    4.414703
10       ANTRI    4.291958
1         MUUH    3.971081
5     PRITRATH    3.842352
2025-08-05 12:47:13,450 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:47:16,529 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:47:19,639 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:47:20,108 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 12:47:21,964 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:47:21,964 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:47:21,964 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:47:28,675 - flag1.src.imputation - DEBUG - Training ordinal model with 1121368 samples. Class distribution:
estadiamento_ordinal
0     50696
1    237743
2    295438
3    281540
4    255951
Name: count, dtype: int64
2025-08-05 12:47:28,684 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.42389143127663, 1: 0.9433447041553273, 2: 0.7591223877767924, 3: 0.7965958655963629, 4: 0.8762364671362878}
2025-08-05 12:47:55,538 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:47:55,538 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:47:55,538 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:47:55,541 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:47:55,541 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:47:55,545 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236350), 3: np.int64(225232), 4: np.int64(204761), 1: np.int64(190194), 0: np.int64(40557)}
2025-08-05 12:47:55,547 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59088), 3: np.int64(56308), 4: np.int64(51190), 1: np.int64(47549), 0: np.int64(10139)}
2025-08-05 12:47:55,547 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:47:55,548 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.862920
2          T   16.794758
4   LOCTUDET   11.648164
5          M    9.020764
11        pT    6.370857
6   LOCTUPRI    5.832597
1       CNES    4.779013
10         N    3.515422
15  ESTDFIMT    3.466817
3       MUUH    2.762596
2025-08-05 12:47:56,481 - flag1.src.imputation - INFO - Ordinal model - Iter 22 - Val LogLoss: 0.5070 - Accuracy: 0.8494 - Classes: [0 1 2 3 4]
2025-08-05 12:47:56,484 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.862920
2          T   16.794758
4   LOCTUDET   11.648164
5          M    9.020764
11        pT    6.370857
6   LOCTUPRI    5.832597
1       CNES    4.779013
10         N    3.515422
15  ESTDFIMT    3.466817
3       MUUH    2.762596
2025-08-05 12:47:57,691 - root - DEBUG - Processed 50000/641934 samples (7.8%)
2025-08-05 12:48:01,107 - root - DEBUG - Processed 550000/641934 samples (85.7%)
2025-08-05 12:48:16,147 - flag1.src.imputation - INFO - Imputed 641934 MAR values.
2025-08-05 12:48:26,899 - flag1.src.imputation - INFO - Imputed 641934 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:48:37,758 - flag1.src.imputation - INFO - Imputed 641934 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:48:39,307 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:48:39,315 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814026
4     580146
2     488536
3     482864
1     423711
0      87214
99         0
Name: count, dtype: int64
2025-08-05 12:48:40,549 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:48:40,557 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814026
4     592623
3     503972
2     467146
1     409529
0      89201
99         0
Name: count, dtype: int64
2025-08-05 12:48:41,795 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:48:41,803 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814026
4     706761
2     450965
3     430637
1     385149
0      88959
99         0
Name: count, dtype: int64
2025-08-05 12:48:42,622 - flag1.src.imputation - INFO - Completed imputation 22/100 in 212.62 seconds
2025-08-05 12:48:42,622 - flag1.src.imputation - INFO - Estimated time remaining: 12.6 minutes
2025-08-05 12:48:42,622 - root - DEBUG - Imputation 22 completed in 212.62s
2025-08-05 12:48:42,622 - flag1.src.imputation - INFO - Starting imputation 23/100
2025-08-05 12:48:47,441 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:48:47,441 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:48:47,442 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:48:47,442 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:48:48,377 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 12:50:42,918 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:50:42,918 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:50:42,918 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:50:42,923 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:50:42,924 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:50:42,930 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135938), 1: np.int64(322114)}
2025-08-05 12:50:42,931 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283985), 1: np.int64(80528)}
2025-08-05 12:50:42,932 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:50:42,933 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.920622
3     LOCTUPRI   16.070677
11  DATAPRICON   11.172881
2     LOCTUDET    9.581773
6      CLITRAT    4.831194
9     DTTRIAGE    4.746118
10       ANTRI    4.605671
5     PRITRATH    4.330183
1         MUUH    3.911064
8      CLIATEN    3.849500
2025-08-05 12:50:44,340 - flag1.src.imputation - INFO - Binary model - Iter 23 - Val LogLoss: 0.2048 - Accuracy: 0.9362 - Classes: [0 1]
2025-08-05 12:50:44,343 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.920622
3     LOCTUPRI   16.070677
11  DATAPRICON   11.172881
2     LOCTUDET    9.581773
6      CLITRAT    4.831194
9     DTTRIAGE    4.746118
10       ANTRI    4.605671
5     PRITRATH    4.330183
1         MUUH    3.911064
8      CLIATEN    3.849500
2025-08-05 12:50:45,699 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:50:48,783 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:50:51,898 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:50:52,367 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 12:50:54,332 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:50:54,332 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:50:54,332 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:51:01,039 - flag1.src.imputation - DEBUG - Training ordinal model with 1121277 samples. Class distribution:
estadiamento_ordinal
0     51042
1    238628
2    295220
3    280852
4    255535
Name: count, dtype: int64
2025-08-05 12:51:01,047 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.3935464911249555, 1: 0.9397698509814439, 2: 0.7596212993699614, 3: 0.7984824747553871, 4: 0.8775917193339464}
2025-08-05 12:51:27,568 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:51:27,568 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:51:27,568 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:51:27,571 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:51:27,572 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:51:27,576 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236176), 3: np.int64(224681), 4: np.int64(204428), 1: np.int64(190902), 0: np.int64(40834)}
2025-08-05 12:51:27,577 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59044), 3: np.int64(56171), 4: np.int64(51107), 1: np.int64(47726), 0: np.int64(10208)}
2025-08-05 12:51:27,578 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:51:27,579 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.679057
2          T   17.607345
4   LOCTUDET   12.150791
5          M    8.751346
11        pT    6.277280
6   LOCTUPRI    5.013083
1       CNES    4.716768
10         N    3.661943
15  ESTDFIMT    3.599740
7       PTNM    2.781150
2025-08-05 12:51:28,521 - flag1.src.imputation - INFO - Ordinal model - Iter 23 - Val LogLoss: 0.5071 - Accuracy: 0.8479 - Classes: [0 1 2 3 4]
2025-08-05 12:51:28,524 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.679057
2          T   17.607345
4   LOCTUDET   12.150791
5          M    8.751346
11        pT    6.277280
6   LOCTUPRI    5.013083
1       CNES    4.716768
10         N    3.661943
15  ESTDFIMT    3.599740
7       PTNM    2.781150
2025-08-05 12:51:29,745 - root - DEBUG - Processed 50000/644345 samples (7.8%)
2025-08-05 12:51:33,165 - root - DEBUG - Processed 550000/644345 samples (85.4%)
2025-08-05 12:51:48,269 - flag1.src.imputation - INFO - Imputed 644345 MAR values.
2025-08-05 12:51:59,080 - flag1.src.imputation - INFO - Imputed 644345 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:52:09,968 - flag1.src.imputation - INFO - Imputed 644345 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:52:11,539 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:52:11,547 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811615
4     581962
2     486888
3     482720
1     425525
0      87787
99         0
Name: count, dtype: int64
2025-08-05 12:52:12,776 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:52:12,785 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811615
4     595970
3     499706
2     467313
1     410575
0      91318
99         0
Name: count, dtype: int64
2025-08-05 12:52:14,060 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:52:14,069 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811615
4     704685
2     451488
3     431312
1     387100
0      90297
99         0
Name: count, dtype: int64
2025-08-05 12:52:14,887 - flag1.src.imputation - INFO - Completed imputation 23/100 in 212.26 seconds
2025-08-05 12:52:14,887 - flag1.src.imputation - INFO - Estimated time remaining: 11.8 minutes
2025-08-05 12:52:14,887 - root - DEBUG - Imputation 23 completed in 212.26s
2025-08-05 12:52:14,887 - flag1.src.imputation - INFO - Starting imputation 24/100
2025-08-05 12:52:19,720 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:52:19,720 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:52:19,720 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:52:19,720 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:52:20,659 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 12:54:15,108 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:54:15,108 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:54:15,108 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:54:15,113 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:54:15,114 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:54:15,120 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136157), 1: np.int64(321895)}
2025-08-05 12:54:15,122 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284039), 1: np.int64(80474)}
2025-08-05 12:54:15,123 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:54:15,123 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.646996
3     LOCTUPRI   15.591414
11  DATAPRICON   10.459442
2     LOCTUDET   10.236584
10       ANTRI    4.547493
6      CLITRAT    4.510567
8      CLIATEN    4.279880
5     PRITRATH    4.014939
1         MUUH    3.917837
9     DTTRIAGE    3.891271
2025-08-05 12:54:16,563 - flag1.src.imputation - INFO - Binary model - Iter 24 - Val LogLoss: 0.2027 - Accuracy: 0.9362 - Classes: [0 1]
2025-08-05 12:54:16,566 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.646996
3     LOCTUPRI   15.591414
11  DATAPRICON   10.459442
2     LOCTUDET   10.236584
10       ANTRI    4.547493
6      CLITRAT    4.510567
8      CLIATEN    4.279880
5     PRITRATH    4.014939
1         MUUH    3.917837
9     DTTRIAGE    3.891271
2025-08-05 12:54:17,939 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:54:21,113 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:54:24,250 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:54:24,722 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 12:54:26,655 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:54:26,655 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:54:26,678 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:54:33,384 - flag1.src.imputation - DEBUG - Training ordinal model with 1121609 samples. Class distribution:
estadiamento_ordinal
0     50550
1    238449
2    295535
3    281219
4    255856
Name: count, dtype: int64
2025-08-05 12:54:33,392 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.43762215628091, 1: 0.9407537880217572, 2: 0.7590363239548615, 3: 0.7976765439035058, 4: 0.8767502032393221}
2025-08-05 12:55:00,011 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:55:00,011 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:55:00,011 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:55:00,014 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:55:00,015 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:55:00,018 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236428), 3: np.int64(224975), 4: np.int64(204685), 1: np.int64(190759), 0: np.int64(40440)}
2025-08-05 12:55:00,020 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59107), 3: np.int64(56244), 4: np.int64(51171), 1: np.int64(47690), 0: np.int64(10110)}
2025-08-05 12:55:00,020 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:55:00,021 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.514200
2          T   17.099417
4   LOCTUDET   10.424785
5          M    8.769150
11        pT    6.421591
6   LOCTUPRI    6.095985
1       CNES    4.987682
10         N    3.642127
15  ESTDFIMT    3.463178
3       MUUH    2.803299
2025-08-05 12:55:00,949 - flag1.src.imputation - INFO - Ordinal model - Iter 24 - Val LogLoss: 0.5054 - Accuracy: 0.8489 - Classes: [0 1 2 3 4]
2025-08-05 12:55:00,952 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.514200
2          T   17.099417
4   LOCTUDET   10.424785
5          M    8.769150
11        pT    6.421591
6   LOCTUPRI    6.095985
1       CNES    4.987682
10         N    3.642127
15  ESTDFIMT    3.463178
3       MUUH    2.803299
2025-08-05 12:55:02,171 - root - DEBUG - Processed 50000/643621 samples (7.8%)
2025-08-05 12:55:05,627 - root - DEBUG - Processed 550000/643621 samples (85.5%)
2025-08-05 12:55:20,720 - flag1.src.imputation - INFO - Imputed 643621 MAR values.
2025-08-05 12:55:31,531 - flag1.src.imputation - INFO - Imputed 643621 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:55:42,423 - flag1.src.imputation - INFO - Imputed 643621 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:55:43,968 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:55:43,976 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812339
4     582459
2     488512
3     481210
1     424844
0      87133
99         0
Name: count, dtype: int64
2025-08-05 12:55:45,235 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:55:45,244 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812339
4     596128
3     503098
2     467965
1     408707
0      88260
99         0
Name: count, dtype: int64
2025-08-05 12:55:46,514 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:55:46,533 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812339
4     709084
2     455043
3     429797
1     383372
0      86862
99         0
Name: count, dtype: int64
2025-08-05 12:55:47,348 - flag1.src.imputation - INFO - Completed imputation 24/100 in 212.46 seconds
2025-08-05 12:55:47,349 - flag1.src.imputation - INFO - Estimated time remaining: 11.2 minutes
2025-08-05 12:55:47,349 - root - DEBUG - Imputation 24 completed in 212.46s
2025-08-05 12:55:47,349 - flag1.src.imputation - INFO - Starting imputation 25/100
2025-08-05 12:55:52,164 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:55:52,164 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:55:52,165 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:55:52,165 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:55:53,101 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 12:57:48,436 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:57:48,437 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 12:57:48,437 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 12:57:48,441 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 12:57:48,442 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 12:57:48,448 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136665), 1: np.int64(321387)}
2025-08-05 12:57:48,450 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284166), 1: np.int64(80347)}
2025-08-05 12:57:48,451 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 12:57:48,452 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.045756
3     LOCTUPRI   16.374759
11  DATAPRICON   10.460992
2     LOCTUDET    9.309157
9     DTTRIAGE    4.745514
6      CLITRAT    4.555813
10       ANTRI    4.541365
5     PRITRATH    4.147163
1         MUUH    4.135715
8      CLIATEN    4.055361
2025-08-05 12:57:49,838 - flag1.src.imputation - INFO - Binary model - Iter 25 - Val LogLoss: 0.2045 - Accuracy: 0.9357 - Classes: [0 1]
2025-08-05 12:57:49,841 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.045756
3     LOCTUPRI   16.374759
11  DATAPRICON   10.460992
2     LOCTUDET    9.309157
9     DTTRIAGE    4.745514
6      CLITRAT    4.555813
10       ANTRI    4.541365
5     PRITRATH    4.147163
1         MUUH    4.135715
8      CLIATEN    4.055361
2025-08-05 12:57:51,258 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 12:57:54,390 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 12:57:57,515 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 12:57:57,987 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 12:57:59,883 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 12:57:59,883 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:57:59,883 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 12:58:06,652 - flag1.src.imputation - DEBUG - Training ordinal model with 1121700 samples. Class distribution:
estadiamento_ordinal
0     50757
1    238577
2    295215
3    281118
4    256033
Name: count, dtype: int64
2025-08-05 12:58:06,660 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.419882971806844, 1: 0.9403253456955197, 2: 0.7599207357349728, 3: 0.7980278744157258, 4: 0.8762151753875477}
2025-08-05 12:58:33,343 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 12:58:33,343 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 12:58:33,343 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 12:58:33,346 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 12:58:33,347 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 12:58:33,350 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236172), 3: np.int64(224894), 4: np.int64(204826), 1: np.int64(190862), 0: np.int64(40606)}
2025-08-05 12:58:33,352 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59043), 3: np.int64(56224), 4: np.int64(51207), 1: np.int64(47715), 0: np.int64(10151)}
2025-08-05 12:58:33,352 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 12:58:33,353 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   20.016461
2          T   16.832090
4   LOCTUDET   11.303415
5          M    9.006426
11        pT    6.338659
6   LOCTUPRI    5.718063
1       CNES    4.581311
15  ESTDFIMT    3.588489
10         N    3.374766
3       MUUH    2.535393
2025-08-05 12:58:34,286 - flag1.src.imputation - INFO - Ordinal model - Iter 25 - Val LogLoss: 0.5038 - Accuracy: 0.8487 - Classes: [0 1 2 3 4]
2025-08-05 12:58:34,289 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   20.016461
2          T   16.832090
4   LOCTUDET   11.303415
5          M    9.006426
11        pT    6.338659
6   LOCTUPRI    5.718063
1       CNES    4.581311
15  ESTDFIMT    3.588489
10         N    3.374766
3       MUUH    2.535393
2025-08-05 12:58:35,526 - root - DEBUG - Processed 50000/643863 samples (7.8%)
2025-08-05 12:58:39,003 - root - DEBUG - Processed 550000/643863 samples (85.4%)
2025-08-05 12:58:54,088 - flag1.src.imputation - INFO - Imputed 643863 MAR values.
2025-08-05 12:59:04,910 - flag1.src.imputation - INFO - Imputed 643863 values for MNAR scenario 'mnar_adv'.
2025-08-05 12:59:15,816 - flag1.src.imputation - INFO - Imputed 643863 values for MNAR scenario 'mnar_s4'.
2025-08-05 12:59:17,366 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:59:17,375 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812097
4     582243
2     488603
3     482744
1     423139
0      87671
99         0
Name: count, dtype: int64
2025-08-05 12:59:18,610 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:59:18,619 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812097
4     597053
3     504026
2     466823
1     410421
0      86077
99         0
Name: count, dtype: int64
2025-08-05 12:59:19,878 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 12:59:19,887 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812097
4     707410
2     453588
3     430357
1     386239
0      86806
99         0
Name: count, dtype: int64
2025-08-05 12:59:20,702 - flag1.src.imputation - INFO - Completed imputation 25/100 in 213.35 seconds
2025-08-05 12:59:20,702 - flag1.src.imputation - INFO - Estimated time remaining: 10.7 minutes
2025-08-05 12:59:20,702 - root - DEBUG - Imputation 25 completed in 213.35s
2025-08-05 12:59:20,702 - flag1.src.imputation - INFO - Starting imputation 26/100
2025-08-05 12:59:25,520 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 12:59:25,521 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 12:59:25,521 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 12:59:25,521 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 12:59:26,462 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 13:01:22,287 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:01:22,287 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:01:22,287 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:01:22,292 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:01:22,293 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:01:22,299 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135158), 1: np.int64(322894)}
2025-08-05 13:01:22,300 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283789), 1: np.int64(80724)}
2025-08-05 13:01:22,301 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:01:22,302 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.554295
3     LOCTUPRI   16.068130
11  DATAPRICON   10.501679
2     LOCTUDET    9.792582
10       ANTRI    4.664999
6      CLITRAT    4.482125
1         MUUH    4.383340
8      CLIATEN    4.376341
5     PRITRATH    4.089812
9     DTTRIAGE    3.749532
2025-08-05 13:01:23,714 - flag1.src.imputation - INFO - Binary model - Iter 26 - Val LogLoss: 0.2055 - Accuracy: 0.9358 - Classes: [0 1]
2025-08-05 13:01:23,717 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.554295
3     LOCTUPRI   16.068130
11  DATAPRICON   10.501679
2     LOCTUDET    9.792582
10       ANTRI    4.664999
6      CLITRAT    4.482125
1         MUUH    4.383340
8      CLIATEN    4.376341
5     PRITRATH    4.089812
9     DTTRIAGE    3.749532
2025-08-05 13:01:24,955 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:01:28,074 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:01:31,177 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:01:31,647 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 13:01:33,489 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:01:33,489 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:01:33,489 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:01:40,187 - flag1.src.imputation - DEBUG - Training ordinal model with 1120786 samples. Class distribution:
estadiamento_ordinal
0     51070
1    238458
2    295309
3    280263
4    255686
Name: count, dtype: int64
2025-08-05 13:01:40,195 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.389214803211279, 1: 0.9400280133189073, 2: 0.7590598322435144, 3: 0.7998101782968141, 4: 0.8766893768137481}
2025-08-05 13:02:06,984 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:02:06,984 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:02:06,984 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:02:06,987 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:02:06,988 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:02:06,991 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236247), 3: np.int64(224210), 4: np.int64(204549), 1: np.int64(190766), 0: np.int64(40856)}
2025-08-05 13:02:06,993 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59062), 3: np.int64(56053), 4: np.int64(51137), 1: np.int64(47692), 0: np.int64(10214)}
2025-08-05 13:02:06,993 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:02:06,994 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.992542
2          T   17.416174
4   LOCTUDET   12.164009
5          M    8.883742
11        pT    6.171784
6   LOCTUPRI    4.871103
1       CNES    4.789638
10         N    3.731058
15  ESTDFIMT    3.589849
3       MUUH    2.882167
2025-08-05 13:02:07,919 - flag1.src.imputation - INFO - Ordinal model - Iter 26 - Val LogLoss: 0.5103 - Accuracy: 0.8481 - Classes: [0 1 2 3 4]
2025-08-05 13:02:07,922 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.992542
2          T   17.416174
4   LOCTUDET   12.164009
5          M    8.883742
11        pT    6.171784
6   LOCTUPRI    4.871103
1       CNES    4.789638
10         N    3.731058
15  ESTDFIMT    3.589849
3       MUUH    2.882167
2025-08-05 13:02:09,130 - root - DEBUG - Processed 50000/644699 samples (7.8%)
2025-08-05 13:02:12,562 - root - DEBUG - Processed 550000/644699 samples (85.3%)
2025-08-05 13:02:27,647 - flag1.src.imputation - INFO - Imputed 644699 MAR values.
2025-08-05 13:02:38,430 - flag1.src.imputation - INFO - Imputed 644699 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:02:49,351 - flag1.src.imputation - INFO - Imputed 644699 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:02:50,899 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:02:50,908 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811261
4     579241
2     486703
3     485933
1     426872
0      86487
99         0
Name: count, dtype: int64
2025-08-05 13:02:52,137 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:02:52,146 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811261
4     595032
3     504758
2     464943
1     413576
0      86927
99         0
Name: count, dtype: int64
2025-08-05 13:02:53,359 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:02:53,368 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    811261
4     708662
2     450462
3     433200
1     391990
0      80922
99         0
Name: count, dtype: int64
2025-08-05 13:02:54,185 - flag1.src.imputation - INFO - Completed imputation 26/100 in 213.48 seconds
2025-08-05 13:02:54,185 - flag1.src.imputation - INFO - Estimated time remaining: 10.1 minutes
2025-08-05 13:02:54,185 - root - DEBUG - Imputation 26 completed in 213.48s
2025-08-05 13:02:54,185 - flag1.src.imputation - INFO - Starting imputation 27/100
2025-08-05 13:02:59,003 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:02:59,004 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:02:59,004 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:02:59,004 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:02:59,939 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:04:55,553 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:04:55,553 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:04:55,553 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:04:55,558 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:04:55,559 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:04:55,565 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136289), 1: np.int64(321763)}
2025-08-05 13:04:55,567 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284072), 1: np.int64(80441)}
2025-08-05 13:04:55,567 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:04:55,568 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.421798
3     LOCTUPRI   15.610063
11  DATAPRICON   10.717836
2     LOCTUDET   10.011822
10       ANTRI    4.856993
6      CLITRAT    4.516629
5     PRITRATH    4.101540
9     DTTRIAGE    4.064974
8      CLIATEN    3.816442
1         MUUH    3.311290
2025-08-05 13:04:56,977 - flag1.src.imputation - INFO - Binary model - Iter 27 - Val LogLoss: 0.2030 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 13:04:56,980 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.421798
3     LOCTUPRI   15.610063
11  DATAPRICON   10.717836
2     LOCTUDET   10.011822
10       ANTRI    4.856993
6      CLITRAT    4.516629
5     PRITRATH    4.101540
9     DTTRIAGE    4.064974
8      CLIATEN    3.816442
1         MUUH    3.311290
2025-08-05 13:04:58,245 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:05:01,377 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:05:04,479 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:05:04,952 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 13:05:06,791 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:05:06,791 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:05:06,791 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:05:13,480 - flag1.src.imputation - DEBUG - Training ordinal model with 1121747 samples. Class distribution:
estadiamento_ordinal
0     50668
1    238735
2    295898
3    281071
4    255375
Name: count, dtype: int64
2025-08-05 13:05:13,522 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.427832162311518, 1: 0.9397423921921796, 2: 0.7581984332438881, 3: 0.798194762177528, 4: 0.8785096426823299}
2025-08-05 13:05:40,106 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:05:40,106 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:05:40,106 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:05:40,109 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:05:40,110 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:05:40,114 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236718), 3: np.int64(224857), 4: np.int64(204300), 1: np.int64(190988), 0: np.int64(40534)}
2025-08-05 13:05:40,115 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59180), 3: np.int64(56214), 4: np.int64(51075), 1: np.int64(47747), 0: np.int64(10134)}
2025-08-05 13:05:40,116 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:05:40,116 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.343043
2          T   17.409267
4   LOCTUDET   11.664056
5          M    8.823035
11        pT    6.322176
6   LOCTUPRI    5.208491
1       CNES    4.730249
10         N    3.491995
15  ESTDFIMT    3.434003
7       PTNM    2.718420
2025-08-05 13:05:41,046 - flag1.src.imputation - INFO - Ordinal model - Iter 27 - Val LogLoss: 0.5132 - Accuracy: 0.8459 - Classes: [0 1 2 3 4]
2025-08-05 13:05:41,049 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.343043
2          T   17.409267
4   LOCTUDET   11.664056
5          M    8.823035
11        pT    6.322176
6   LOCTUPRI    5.208491
1       CNES    4.730249
10         N    3.491995
15  ESTDFIMT    3.434003
7       PTNM    2.718420
2025-08-05 13:05:42,268 - root - DEBUG - Processed 50000/645523 samples (7.7%)
2025-08-05 13:05:45,711 - root - DEBUG - Processed 550000/645523 samples (85.2%)
2025-08-05 13:06:00,831 - flag1.src.imputation - INFO - Imputed 645523 MAR values.
2025-08-05 13:06:11,636 - flag1.src.imputation - INFO - Imputed 645523 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:06:22,603 - flag1.src.imputation - INFO - Imputed 645523 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:06:24,162 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:06:24,170 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810437
4     583343
2     492955
3     480362
1     423076
0      86324
99         0
Name: count, dtype: int64
2025-08-05 13:06:25,372 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:06:25,381 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810437
4     597891
3     501972
2     469681
1     410285
0      86231
99         0
Name: count, dtype: int64
2025-08-05 13:06:26,622 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:06:26,631 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810437
4     707647
2     454568
3     428846
1     386994
0      88005
99         0
Name: count, dtype: int64
2025-08-05 13:06:27,466 - flag1.src.imputation - INFO - Completed imputation 27/100 in 213.28 seconds
2025-08-05 13:06:27,467 - flag1.src.imputation - INFO - Estimated time remaining: 9.6 minutes
2025-08-05 13:06:27,467 - root - DEBUG - Imputation 27 completed in 213.28s
2025-08-05 13:06:27,467 - flag1.src.imputation - INFO - Starting imputation 28/100
2025-08-05 13:06:32,294 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:06:32,295 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:06:32,295 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:06:32,295 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:06:33,227 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:08:27,685 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:08:27,685 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:08:27,685 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:08:27,690 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:08:27,691 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:08:27,697 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136274), 1: np.int64(321778)}
2025-08-05 13:08:27,699 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284068), 1: np.int64(80445)}
2025-08-05 13:08:27,699 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:08:27,700 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.391669
3     LOCTUPRI   15.946175
11  DATAPRICON   10.485702
2     LOCTUDET    9.554185
6      CLITRAT    4.506504
10       ANTRI    4.493866
1         MUUH    4.479078
5     PRITRATH    4.327843
8      CLIATEN    4.309838
9     DTTRIAGE    4.276157
2025-08-05 13:08:29,096 - flag1.src.imputation - INFO - Binary model - Iter 28 - Val LogLoss: 0.2041 - Accuracy: 0.9363 - Classes: [0 1]
2025-08-05 13:08:29,099 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.391669
3     LOCTUPRI   15.946175
11  DATAPRICON   10.485702
2     LOCTUDET    9.554185
6      CLITRAT    4.506504
10       ANTRI    4.493866
1         MUUH    4.479078
5     PRITRATH    4.327843
8      CLIATEN    4.309838
9     DTTRIAGE    4.276157
2025-08-05 13:08:30,452 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:08:33,604 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:08:36,698 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:08:37,171 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.9% as 'não estadiável' (1), 61.1% as 'estadiável' (0)
2025-08-05 13:08:39,030 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:08:39,031 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:08:39,031 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:08:45,822 - flag1.src.imputation - DEBUG - Training ordinal model with 1121442 samples. Class distribution:
estadiamento_ordinal
0     50944
1    238884
2    295245
3    280690
4    255679
Name: count, dtype: int64
2025-08-05 13:08:45,830 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.402646042713568, 1: 0.9389008891344753, 2: 0.7596687496824671, 3: 0.7990608856745877, 4: 0.8772265223190016}
2025-08-05 13:09:12,405 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:09:12,405 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:09:12,405 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:09:12,408 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:09:12,409 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:09:12,413 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236196), 3: np.int64(224552), 4: np.int64(204543), 1: np.int64(191107), 0: np.int64(40755)}
2025-08-05 13:09:12,414 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59049), 3: np.int64(56138), 4: np.int64(51136), 1: np.int64(47777), 0: np.int64(10189)}
2025-08-05 13:09:12,415 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:09:12,415 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.148188
2          T   17.582595
4   LOCTUDET   11.562099
5          M    9.144515
11        pT    6.317458
6   LOCTUPRI    5.076137
1       CNES    4.840700
15  ESTDFIMT    3.699048
10         N    3.542161
7       PTNM    3.035409
2025-08-05 13:09:13,349 - flag1.src.imputation - INFO - Ordinal model - Iter 28 - Val LogLoss: 0.5132 - Accuracy: 0.8463 - Classes: [0 1 2 3 4]
2025-08-05 13:09:13,352 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.148188
2          T   17.582595
4   LOCTUDET   11.562099
5          M    9.144515
11        pT    6.317458
6   LOCTUPRI    5.076137
1       CNES    4.840700
15  ESTDFIMT    3.699048
10         N    3.542161
7       PTNM    3.035409
2025-08-05 13:09:14,579 - root - DEBUG - Processed 50000/643935 samples (7.8%)
2025-08-05 13:09:18,047 - root - DEBUG - Processed 550000/643935 samples (85.4%)
2025-08-05 13:09:33,129 - flag1.src.imputation - INFO - Imputed 643935 MAR values.
2025-08-05 13:09:43,904 - flag1.src.imputation - INFO - Imputed 643935 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:09:54,831 - flag1.src.imputation - INFO - Imputed 643935 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:09:56,381 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:09:56,389 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812025
4     585798
2     485813
3     479222
1     424167
0      89472
99         0
Name: count, dtype: int64
2025-08-05 13:09:57,606 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:09:57,615 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812025
4     598084
3     500955
2     467085
1     409763
0      88585
99         0
Name: count, dtype: int64
2025-08-05 13:09:58,825 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:09:58,833 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812025
4     709818
2     450247
3     428385
1     387397
0      88625
99         0
Name: count, dtype: int64
2025-08-05 13:09:59,651 - flag1.src.imputation - INFO - Completed imputation 28/100 in 212.18 seconds
2025-08-05 13:09:59,651 - flag1.src.imputation - INFO - Estimated time remaining: 9.1 minutes
2025-08-05 13:09:59,651 - root - DEBUG - Imputation 28 completed in 212.18s
2025-08-05 13:09:59,651 - flag1.src.imputation - INFO - Starting imputation 29/100
2025-08-05 13:10:04,486 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:10:04,487 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:10:04,487 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:10:04,487 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:10:05,422 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 13:12:00,720 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:12:00,720 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:12:00,720 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:12:00,725 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:12:00,726 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:12:00,732 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136565), 1: np.int64(321487)}
2025-08-05 13:12:00,734 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284141), 1: np.int64(80372)}
2025-08-05 13:12:00,735 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:12:00,735 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.763919
3     LOCTUPRI   15.966227
2     LOCTUDET   10.108287
11  DATAPRICON   10.038097
10       ANTRI    4.751139
6      CLITRAT    4.724371
9     DTTRIAGE    4.561887
5     PRITRATH    4.264128
8      CLIATEN    4.093493
1         MUUH    4.015499
2025-08-05 13:12:02,307 - flag1.src.imputation - INFO - Binary model - Iter 29 - Val LogLoss: 0.2037 - Accuracy: 0.9361 - Classes: [0 1]
2025-08-05 13:12:02,310 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.763919
3     LOCTUPRI   15.966227
2     LOCTUDET   10.108287
11  DATAPRICON   10.038097
10       ANTRI    4.751139
6      CLITRAT    4.724371
9     DTTRIAGE    4.561887
5     PRITRATH    4.264128
8      CLIATEN    4.093493
1         MUUH    4.015499
2025-08-05 13:12:03,544 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:12:06,825 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:12:10,094 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:12:10,594 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 13:12:12,511 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:12:12,511 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:12:12,511 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:12:19,410 - flag1.src.imputation - DEBUG - Training ordinal model with 1121621 samples. Class distribution:
estadiamento_ordinal
0     50600
1    238594
2    295011
3    281419
4    255997
Name: count, dtype: int64
2025-08-05 13:12:19,418 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.433284584980237, 1: 0.9401921255354284, 2: 0.7603926633244185, 3: 0.7971181761004055, 4: 0.8762766751172866}
2025-08-05 13:12:46,394 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:12:46,394 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:12:46,395 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:12:46,397 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:12:46,398 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:12:46,402 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236009), 3: np.int64(225135), 4: np.int64(204797), 1: np.int64(190875), 0: np.int64(40480)}
2025-08-05 13:12:46,403 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59002), 3: np.int64(56284), 4: np.int64(51200), 1: np.int64(47719), 0: np.int64(10120)}
2025-08-05 13:12:46,404 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:12:46,405 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.887390
2          T   16.566365
4   LOCTUDET   11.162291
5          M    8.922285
11        pT    6.185828
6   LOCTUPRI    5.821665
1       CNES    4.723768
10         N    3.762038
15  ESTDFIMT    3.581528
3       MUUH    2.863375
2025-08-05 13:12:47,378 - flag1.src.imputation - INFO - Ordinal model - Iter 29 - Val LogLoss: 0.5069 - Accuracy: 0.8484 - Classes: [0 1 2 3 4]
2025-08-05 13:12:47,381 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.887390
2          T   16.566365
4   LOCTUDET   11.162291
5          M    8.922285
11        pT    6.185828
6   LOCTUPRI    5.821665
1       CNES    4.723768
10         N    3.762038
15  ESTDFIMT    3.581528
3       MUUH    2.863375
2025-08-05 13:12:48,627 - root - DEBUG - Processed 50000/643005 samples (7.8%)
2025-08-05 13:12:52,230 - root - DEBUG - Processed 550000/643005 samples (85.5%)
2025-08-05 13:13:07,591 - flag1.src.imputation - INFO - Imputed 643005 MAR values.
2025-08-05 13:13:18,369 - flag1.src.imputation - INFO - Imputed 643005 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:13:29,285 - flag1.src.imputation - INFO - Imputed 643005 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:13:30,889 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:13:30,897 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812955
4     581578
2     487829
3     482285
1     427084
0      84766
99         0
Name: count, dtype: int64
2025-08-05 13:13:32,190 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:13:32,199 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812955
4     596243
3     502758
2     465939
1     412573
0      86029
99         0
Name: count, dtype: int64
2025-08-05 13:13:33,479 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:13:33,488 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812955
4     706717
2     451968
3     431632
1     388244
0      84981
99         0
Name: count, dtype: int64
2025-08-05 13:13:34,317 - flag1.src.imputation - INFO - Completed imputation 29/100 in 214.67 seconds
2025-08-05 13:13:34,317 - flag1.src.imputation - INFO - Estimated time remaining: 8.8 minutes
2025-08-05 13:13:34,317 - root - DEBUG - Imputation 29 completed in 214.67s
2025-08-05 13:13:34,345 - flag1.src.imputation - INFO - Starting imputation 30/100
2025-08-05 13:13:39,357 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:13:39,357 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:13:39,357 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:13:39,357 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:13:40,311 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.52 for binary classification
2025-08-05 13:15:35,365 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:15:35,365 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:15:35,365 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:15:35,370 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:15:35,371 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:15:35,377 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135756), 1: np.int64(322296)}
2025-08-05 13:15:35,378 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283939), 1: np.int64(80574)}
2025-08-05 13:15:35,379 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:15:35,380 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.244993
3     LOCTUPRI   16.192339
11  DATAPRICON   11.137974
2     LOCTUDET    9.930108
6      CLITRAT    4.918489
10       ANTRI    4.584146
9     DTTRIAGE    4.354051
5     PRITRATH    4.134098
8      CLIATEN    3.955189
1         MUUH    3.389853
2025-08-05 13:15:36,843 - flag1.src.imputation - INFO - Binary model - Iter 30 - Val LogLoss: 0.2046 - Accuracy: 0.9355 - Classes: [0 1]
2025-08-05 13:15:36,846 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.244993
3     LOCTUPRI   16.192339
11  DATAPRICON   11.137974
2     LOCTUDET    9.930108
6      CLITRAT    4.918489
10       ANTRI    4.584146
9     DTTRIAGE    4.354051
5     PRITRATH    4.134098
8      CLIATEN    3.955189
1         MUUH    3.389853
2025-08-05 13:15:38,039 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:15:41,237 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:15:44,487 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:15:44,974 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 13:15:46,856 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:15:46,856 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:15:46,856 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:15:53,708 - flag1.src.imputation - DEBUG - Training ordinal model with 1121180 samples. Class distribution:
estadiamento_ordinal
0     51130
1    239069
2    294778
3    280938
4    255265
Name: count, dtype: int64
2025-08-05 13:15:53,717 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.385605319773127, 1: 0.9379551510233447, 2: 0.7606944887338947, 3: 0.7981689910229304, 4: 0.8784439699919692}
2025-08-05 13:16:20,852 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:16:20,852 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:16:20,852 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:16:20,855 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:16:20,855 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:16:20,859 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235823), 3: np.int64(224750), 4: np.int64(204212), 1: np.int64(191255), 0: np.int64(40904)}
2025-08-05 13:16:20,861 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58955), 3: np.int64(56188), 4: np.int64(51053), 1: np.int64(47814), 0: np.int64(10226)}
2025-08-05 13:16:20,861 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:16:20,862 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.433344
2          T   17.191450
4   LOCTUDET   11.392886
5          M    8.597337
11        pT    6.350140
6   LOCTUPRI    5.259958
1       CNES    4.807127
10         N    3.683008
15  ESTDFIMT    3.524180
7       PTNM    2.822795
2025-08-05 13:16:21,821 - flag1.src.imputation - INFO - Ordinal model - Iter 30 - Val LogLoss: 0.5036 - Accuracy: 0.8497 - Classes: [0 1 2 3 4]
2025-08-05 13:16:21,825 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.433344
2          T   17.191450
4   LOCTUDET   11.392886
5          M    8.597337
11        pT    6.350140
6   LOCTUPRI    5.259958
1       CNES    4.807127
10         N    3.683008
15  ESTDFIMT    3.524180
7       PTNM    2.822795
2025-08-05 13:16:23,103 - root - DEBUG - Processed 50000/642830 samples (7.8%)
2025-08-05 13:16:26,672 - root - DEBUG - Processed 550000/642830 samples (85.6%)
2025-08-05 13:16:41,964 - flag1.src.imputation - INFO - Imputed 642830 MAR values.
2025-08-05 13:16:52,709 - flag1.src.imputation - INFO - Imputed 642830 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:17:03,563 - flag1.src.imputation - INFO - Imputed 642830 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:17:05,140 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:17:05,149 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813130
4     584204
2     487745
3     476620
1     429219
0      85579
99         0
Name: count, dtype: int64
2025-08-05 13:17:06,453 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:17:06,462 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813130
4     595832
3     496999
2     468972
1     416239
0      85325
99         0
Name: count, dtype: int64
2025-08-05 13:17:07,723 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:17:07,732 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    813130
4     706600
2     450622
3     429671
1     392671
0      83803
99         0
Name: count, dtype: int64
2025-08-05 13:17:08,559 - flag1.src.imputation - INFO - Completed imputation 30/100 in 214.21 seconds
2025-08-05 13:17:08,559 - flag1.src.imputation - INFO - Estimated time remaining: 8.3 minutes
2025-08-05 13:17:08,560 - root - DEBUG - Imputation 30 completed in 214.21s
2025-08-05 13:17:08,560 - flag1.src.imputation - INFO - Starting imputation 31/100
2025-08-05 13:17:13,524 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:17:13,524 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:17:13,524 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:17:13,524 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:17:14,476 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:19:09,514 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:19:09,514 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:19:09,514 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:19:09,519 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:19:09,520 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:19:09,526 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136130), 1: np.int64(321922)}
2025-08-05 13:19:09,528 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284033), 1: np.int64(80480)}
2025-08-05 13:19:09,529 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:19:09,530 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.149786
3     LOCTUPRI   15.594407
11  DATAPRICON   10.408625
2     LOCTUDET   10.026738
6      CLITRAT    4.921561
10       ANTRI    4.401272
5     PRITRATH    4.193021
9     DTTRIAGE    4.162156
8      CLIATEN    4.018236
1         MUUH    3.670357
2025-08-05 13:19:10,990 - flag1.src.imputation - INFO - Binary model - Iter 31 - Val LogLoss: 0.2070 - Accuracy: 0.9355 - Classes: [0 1]
2025-08-05 13:19:10,993 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.149786
3     LOCTUPRI   15.594407
11  DATAPRICON   10.408625
2     LOCTUDET   10.026738
6      CLITRAT    4.921561
10       ANTRI    4.401272
5     PRITRATH    4.193021
9     DTTRIAGE    4.162156
8      CLIATEN    4.018236
1         MUUH    3.670357
2025-08-05 13:19:12,436 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:19:15,687 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:19:18,886 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:19:19,376 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 13:19:21,280 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:19:21,280 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:19:21,280 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:19:28,203 - flag1.src.imputation - DEBUG - Training ordinal model with 1120618 samples. Class distribution:
estadiamento_ordinal
0     50753
1    237894
2    295862
3    280601
4    255508
Name: count, dtype: int64
2025-08-05 13:19:28,212 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.415967529013063, 1: 0.9421153959326423, 2: 0.7575274959271552, 3: 0.7987270180790518, 4: 0.8771686209433756}
2025-08-05 13:19:55,237 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:19:55,237 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:19:55,237 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:19:55,239 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:19:55,240 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:19:55,244 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236690), 3: np.int64(224481), 4: np.int64(204406), 1: np.int64(190315), 0: np.int64(40602)}
2025-08-05 13:19:55,245 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59172), 3: np.int64(56120), 4: np.int64(51102), 1: np.int64(47579), 0: np.int64(10151)}
2025-08-05 13:19:55,246 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:19:55,247 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.445568
2          T   16.979116
4   LOCTUDET   10.533172
5          M    8.888249
6   LOCTUPRI    6.661271
11        pT    6.381586
1       CNES    4.618091
15  ESTDFIMT    3.646630
10         N    3.284788
3       MUUH    2.681320
2025-08-05 13:19:56,182 - flag1.src.imputation - INFO - Ordinal model - Iter 31 - Val LogLoss: 0.5050 - Accuracy: 0.8498 - Classes: [0 1 2 3 4]
2025-08-05 13:19:56,185 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.445568
2          T   16.979116
4   LOCTUDET   10.533172
5          M    8.888249
6   LOCTUPRI    6.661271
11        pT    6.381586
1       CNES    4.618091
15  ESTDFIMT    3.646630
10         N    3.284788
3       MUUH    2.681320
2025-08-05 13:19:57,394 - root - DEBUG - Processed 50000/641785 samples (7.8%)
2025-08-05 13:20:00,928 - root - DEBUG - Processed 550000/641785 samples (85.7%)
2025-08-05 13:20:15,969 - flag1.src.imputation - INFO - Imputed 641785 MAR values.
2025-08-05 13:20:26,693 - flag1.src.imputation - INFO - Imputed 641785 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:20:37,564 - flag1.src.imputation - INFO - Imputed 641785 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:20:39,112 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:20:39,120 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814175
4     578996
2     487019
3     485169
1     422215
0      88923
99         0
Name: count, dtype: int64
2025-08-05 13:20:40,348 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:20:40,356 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814175
4     592788
3     507131
2     465499
1     408927
0      87977
99         0
Name: count, dtype: int64
2025-08-05 13:20:41,642 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:20:41,650 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814175
4     707982
2     449387
3     433048
1     384827
0      87078
99         0
Name: count, dtype: int64
2025-08-05 13:20:42,469 - flag1.src.imputation - INFO - Completed imputation 31/100 in 213.91 seconds
2025-08-05 13:20:42,469 - flag1.src.imputation - INFO - Estimated time remaining: 7.9 minutes
2025-08-05 13:20:42,469 - root - DEBUG - Imputation 31 completed in 213.91s
2025-08-05 13:20:42,469 - flag1.src.imputation - INFO - Starting imputation 32/100
2025-08-05 13:20:47,305 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:20:47,305 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:20:47,305 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:20:47,305 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:20:48,237 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:22:43,882 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:22:43,882 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:22:43,882 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:22:43,887 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:22:43,888 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:22:43,894 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136314), 1: np.int64(321738)}
2025-08-05 13:22:43,895 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284078), 1: np.int64(80435)}
2025-08-05 13:22:43,896 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:22:43,897 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.492141
3     LOCTUPRI   15.615485
11  DATAPRICON   10.943770
2     LOCTUDET   10.298111
10       ANTRI    4.584897
6      CLITRAT    4.527174
1         MUUH    4.514222
8      CLIATEN    4.233276
5     PRITRATH    4.039411
9     DTTRIAGE    3.567486
2025-08-05 13:22:45,327 - flag1.src.imputation - INFO - Binary model - Iter 32 - Val LogLoss: 0.2024 - Accuracy: 0.9359 - Classes: [0 1]
2025-08-05 13:22:45,330 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.492141
3     LOCTUPRI   15.615485
11  DATAPRICON   10.943770
2     LOCTUDET   10.298111
10       ANTRI    4.584897
6      CLITRAT    4.527174
1         MUUH    4.514222
8      CLIATEN    4.233276
5     PRITRATH    4.039411
9     DTTRIAGE    3.567486
2025-08-05 13:22:46,836 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:22:50,057 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:22:53,204 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:22:53,676 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 13:22:55,612 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:22:55,612 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:22:55,612 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:23:02,392 - flag1.src.imputation - DEBUG - Training ordinal model with 1121040 samples. Class distribution:
estadiamento_ordinal
0     50602
1    238929
2    296011
3    280656
4    254842
Name: count, dtype: int64
2025-08-05 13:23:02,400 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.430813011343425, 1: 0.9383875544617857, 2: 0.7574313116742283, 3: 0.7988712160082093, 4: 0.8797921849616626}
2025-08-05 13:23:29,047 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:23:29,047 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:23:29,047 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:23:29,050 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:23:29,050 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:23:29,054 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236809), 3: np.int64(224525), 4: np.int64(203874), 1: np.int64(191143), 0: np.int64(40481)}
2025-08-05 13:23:29,055 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59202), 3: np.int64(56131), 4: np.int64(50968), 1: np.int64(47786), 0: np.int64(10121)}
2025-08-05 13:23:29,056 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:23:29,057 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.846073
2          T   17.490550
4   LOCTUDET   11.726085
5          M    8.732233
11        pT    6.234333
6   LOCTUPRI    5.078492
1       CNES    4.698986
10         N    3.593259
15  ESTDFIMT    3.589148
7       PTNM    2.864260
2025-08-05 13:23:30,008 - flag1.src.imputation - INFO - Ordinal model - Iter 32 - Val LogLoss: 0.5072 - Accuracy: 0.8476 - Classes: [0 1 2 3 4]
2025-08-05 13:23:30,011 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.846073
2          T   17.490550
4   LOCTUDET   11.726085
5          M    8.732233
11        pT    6.234333
6   LOCTUPRI    5.078492
1       CNES    4.698986
10         N    3.593259
15  ESTDFIMT    3.589148
7       PTNM    2.864260
2025-08-05 13:23:31,246 - root - DEBUG - Processed 50000/642965 samples (7.8%)
2025-08-05 13:23:34,697 - root - DEBUG - Processed 550000/642965 samples (85.5%)
2025-08-05 13:23:49,792 - flag1.src.imputation - INFO - Imputed 642965 MAR values.
2025-08-05 13:24:00,549 - flag1.src.imputation - INFO - Imputed 642965 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:24:11,452 - flag1.src.imputation - INFO - Imputed 642965 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:24:13,006 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:24:13,015 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812995
4     576491
2     490403
3     482816
1     427188
0      86604
99         0
Name: count, dtype: int64
2025-08-05 13:24:14,231 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:24:14,239 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812995
4     590763
3     502430
2     468802
1     414987
0      86520
99         0
Name: count, dtype: int64
2025-08-05 13:24:15,518 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:24:15,526 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812995
4     701271
2     452060
3     434011
1     391630
0      84530
99         0
Name: count, dtype: int64
2025-08-05 13:24:16,345 - flag1.src.imputation - INFO - Completed imputation 32/100 in 213.88 seconds
2025-08-05 13:24:16,345 - flag1.src.imputation - INFO - Estimated time remaining: 7.6 minutes
2025-08-05 13:24:16,345 - root - DEBUG - Imputation 32 completed in 213.88s
2025-08-05 13:24:16,345 - flag1.src.imputation - INFO - Starting imputation 33/100
2025-08-05 13:24:21,191 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:24:21,191 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:24:21,191 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:24:21,191 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:24:22,127 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 13:26:17,594 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:26:17,627 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:26:17,627 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:26:17,635 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:26:17,637 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:26:17,649 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136754), 1: np.int64(321298)}
2025-08-05 13:26:17,652 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284189), 1: np.int64(80324)}
2025-08-05 13:26:17,653 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:26:17,654 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.507350
3     LOCTUPRI   15.683404
11  DATAPRICON   11.164640
2     LOCTUDET   10.199051
6      CLITRAT    4.651544
10       ANTRI    4.528346
5     PRITRATH    4.243067
8      CLIATEN    4.219750
1         MUUH    3.789770
9     DTTRIAGE    3.534233
2025-08-05 13:26:19,052 - flag1.src.imputation - INFO - Binary model - Iter 33 - Val LogLoss: 0.2003 - Accuracy: 0.9373 - Classes: [0 1]
2025-08-05 13:26:19,055 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.507350
3     LOCTUPRI   15.683404
11  DATAPRICON   11.164640
2     LOCTUDET   10.199051
6      CLITRAT    4.651544
10       ANTRI    4.528346
5     PRITRATH    4.243067
8      CLIATEN    4.219750
1         MUUH    3.789770
9     DTTRIAGE    3.534233
2025-08-05 13:26:20,528 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:26:23,611 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:26:26,641 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:26:27,101 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.8% as 'não estadiável' (1), 61.2% as 'estadiável' (0)
2025-08-05 13:26:28,889 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:26:28,889 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:26:28,890 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:26:35,508 - flag1.src.imputation - DEBUG - Training ordinal model with 1121602 samples. Class distribution:
estadiamento_ordinal
0     50869
1    237483
2    295973
3    281923
4    255354
Name: count, dtype: int64
2025-08-05 13:26:35,516 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.40976626236018, 1: 0.9445745590210668, 2: 0.7579083227186264, 3: 0.7956796713996375, 4: 0.8784683224073248}
2025-08-05 13:27:02,309 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:27:02,309 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:27:02,309 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:27:02,312 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:27:02,313 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:27:02,317 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236778), 3: np.int64(225538), 4: np.int64(204283), 1: np.int64(189987), 0: np.int64(40695)}
2025-08-05 13:27:02,318 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59195), 3: np.int64(56385), 4: np.int64(51071), 1: np.int64(47496), 0: np.int64(10174)}
2025-08-05 13:27:02,319 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:27:02,319 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.337236
2          T   17.069102
4   LOCTUDET   11.563117
5          M    8.773861
11        pT    6.213390
6   LOCTUPRI    5.544578
1       CNES    5.033966
15  ESTDFIMT    3.631294
10         N    3.490958
3       MUUH    2.931183
2025-08-05 13:27:03,255 - flag1.src.imputation - INFO - Ordinal model - Iter 33 - Val LogLoss: 0.5044 - Accuracy: 0.8492 - Classes: [0 1 2 3 4]
2025-08-05 13:27:03,258 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.337236
2          T   17.069102
4   LOCTUDET   11.563117
5          M    8.773861
11        pT    6.213390
6   LOCTUPRI    5.544578
1       CNES    5.033966
15  ESTDFIMT    3.631294
10         N    3.490958
3       MUUH    2.931183
2025-08-05 13:27:04,464 - root - DEBUG - Processed 50000/644983 samples (7.8%)
2025-08-05 13:27:07,865 - root - DEBUG - Processed 550000/644983 samples (85.3%)
2025-08-05 13:27:22,997 - flag1.src.imputation - INFO - Imputed 644983 MAR values.
2025-08-05 13:27:33,795 - flag1.src.imputation - INFO - Imputed 644983 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:27:44,739 - flag1.src.imputation - INFO - Imputed 644983 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:27:46,260 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:27:46,268 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810977
4     583675
2     492195
3     483934
1     420111
0      85605
99         0
Name: count, dtype: int64
2025-08-05 13:27:47,577 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:27:47,586 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810977
4     599671
3     501892
2     470496
1     407575
0      85886
99         0
Name: count, dtype: int64
2025-08-05 13:27:48,876 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:27:48,888 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    810977
4     707662
2     453648
3     430521
1     385789
0      87900
99         0
Name: count, dtype: int64
2025-08-05 13:27:49,705 - flag1.src.imputation - INFO - Completed imputation 33/100 in 213.36 seconds
2025-08-05 13:27:49,705 - flag1.src.imputation - INFO - Estimated time remaining: 7.2 minutes
2025-08-05 13:27:49,705 - root - DEBUG - Imputation 33 completed in 213.36s
2025-08-05 13:27:49,705 - flag1.src.imputation - INFO - Starting imputation 34/100
2025-08-05 13:27:54,462 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:27:54,462 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:27:54,462 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:27:54,462 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:27:55,353 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 13:29:50,642 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:29:50,672 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:29:50,672 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:29:50,680 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:29:50,682 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:29:50,696 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136709), 1: np.int64(321343)}
2025-08-05 13:29:50,699 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284177), 1: np.int64(80336)}
2025-08-05 13:29:50,700 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:29:50,701 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.333783
3     LOCTUPRI   16.294152
11  DATAPRICON   10.626573
2     LOCTUDET    9.410134
6      CLITRAT    4.990182
1         MUUH    4.750197
10       ANTRI    4.540394
5     PRITRATH    4.367635
9     DTTRIAGE    4.278407
8      CLIATEN    4.107907
2025-08-05 13:29:52,117 - flag1.src.imputation - INFO - Binary model - Iter 34 - Val LogLoss: 0.2023 - Accuracy: 0.9365 - Classes: [0 1]
2025-08-05 13:29:52,120 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.333783
3     LOCTUPRI   16.294152
11  DATAPRICON   10.626573
2     LOCTUDET    9.410134
6      CLITRAT    4.990182
1         MUUH    4.750197
10       ANTRI    4.540394
5     PRITRATH    4.367635
9     DTTRIAGE    4.278407
8      CLIATEN    4.107907
2025-08-05 13:29:53,474 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:29:56,627 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:29:59,740 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:30:00,217 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.2% as 'não estadiável' (1), 60.8% as 'estadiável' (0)
2025-08-05 13:30:02,073 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:30:02,074 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:30:02,074 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:30:08,805 - flag1.src.imputation - DEBUG - Training ordinal model with 1121644 samples. Class distribution:
estadiamento_ordinal
0     50710
1    238377
2    295371
3    280460
4    256726
Name: count, dtype: int64
2025-08-05 13:30:08,814 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.423758627489647, 1: 0.9410673009560486, 2: 0.7594814656821421, 3: 0.7998602296227626, 4: 0.8738063149038274}
2025-08-05 13:30:35,542 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:30:35,542 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:30:35,542 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:30:35,544 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:30:35,545 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:30:35,549 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236297), 3: np.int64(224368), 4: np.int64(205381), 1: np.int64(190701), 0: np.int64(40568)}
2025-08-05 13:30:35,550 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59074), 3: np.int64(56092), 4: np.int64(51345), 1: np.int64(47676), 0: np.int64(10142)}
2025-08-05 13:30:35,551 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:30:35,552 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.409024
2          T   16.634230
4   LOCTUDET   10.915100
5          M    8.833498
6   LOCTUPRI    6.399366
11        pT    6.328970
1       CNES    4.760045
10         N    3.767892
15  ESTDFIMT    3.480644
3       MUUH    2.726028
2025-08-05 13:30:36,484 - flag1.src.imputation - INFO - Ordinal model - Iter 34 - Val LogLoss: 0.5042 - Accuracy: 0.8489 - Classes: [0 1 2 3 4]
2025-08-05 13:30:36,487 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.409024
2          T   16.634230
4   LOCTUDET   10.915100
5          M    8.833498
6   LOCTUPRI    6.399366
11        pT    6.328970
1       CNES    4.760045
10         N    3.767892
15  ESTDFIMT    3.480644
3       MUUH    2.726028
2025-08-05 13:30:37,705 - root - DEBUG - Processed 50000/640520 samples (7.8%)
2025-08-05 13:30:41,194 - root - DEBUG - Processed 550000/640520 samples (85.9%)
2025-08-05 13:30:56,273 - flag1.src.imputation - INFO - Imputed 640520 MAR values.
2025-08-05 13:31:06,990 - flag1.src.imputation - INFO - Imputed 640520 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:31:17,858 - flag1.src.imputation - INFO - Imputed 640520 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:31:19,414 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:31:19,422 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815440
4     577745
2     489832
3     481924
1     425374
0      86182
99         0
Name: count, dtype: int64
2025-08-05 13:31:20,800 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:31:20,809 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815440
4     593279
3     500522
2     469169
1     408862
0      89225
99         0
Name: count, dtype: int64
2025-08-05 13:31:22,102 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:31:22,110 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815440
4     702082
2     455743
3     431978
1     388885
0      82369
99         0
Name: count, dtype: int64
2025-08-05 13:31:22,945 - flag1.src.imputation - INFO - Completed imputation 34/100 in 213.24 seconds
2025-08-05 13:31:22,946 - flag1.src.imputation - INFO - Estimated time remaining: 6.9 minutes
2025-08-05 13:31:22,946 - root - DEBUG - Imputation 34 completed in 213.24s
2025-08-05 13:31:22,946 - flag1.src.imputation - INFO - Starting imputation 35/100
2025-08-05 13:31:27,771 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:31:27,771 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:31:27,771 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:31:27,771 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:31:28,699 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:33:23,913 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:33:23,913 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:33:23,914 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:33:23,919 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:33:23,920 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:33:23,926 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136508), 1: np.int64(321544)}
2025-08-05 13:33:23,928 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284127), 1: np.int64(80386)}
2025-08-05 13:33:23,928 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:33:23,929 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.994610
3     LOCTUPRI   15.802161
11  DATAPRICON   11.284886
2     LOCTUDET   10.264647
6      CLITRAT    4.950646
5     PRITRATH    4.610324
10       ANTRI    4.387750
9     DTTRIAGE    3.905423
8      CLIATEN    3.902734
1         MUUH    3.576941
2025-08-05 13:33:25,314 - flag1.src.imputation - INFO - Binary model - Iter 35 - Val LogLoss: 0.2017 - Accuracy: 0.9368 - Classes: [0 1]
2025-08-05 13:33:25,317 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.994610
3     LOCTUPRI   15.802161
11  DATAPRICON   11.284886
2     LOCTUDET   10.264647
6      CLITRAT    4.950646
5     PRITRATH    4.610324
10       ANTRI    4.387750
9     DTTRIAGE    3.905423
8      CLIATEN    3.902734
1         MUUH    3.576941
2025-08-05 13:33:26,803 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:33:29,942 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:33:33,020 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:33:33,493 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 13:33:35,464 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:33:35,464 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:33:35,464 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:33:42,229 - flag1.src.imputation - DEBUG - Training ordinal model with 1120618 samples. Class distribution:
estadiamento_ordinal
0     50428
1    239096
2    294629
3    280512
4    255953
Name: count, dtype: int64
2025-08-05 13:33:42,238 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.444427698897438, 1: 0.9373791280489845, 2: 0.7606976909944371, 3: 0.7989804357745837, 4: 0.8756435751876321}
2025-08-05 13:34:08,957 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:34:08,957 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:34:08,957 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:34:08,960 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:34:08,961 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:34:08,964 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235703), 3: np.int64(224410), 4: np.int64(204762), 1: np.int64(191277), 0: np.int64(40342)}
2025-08-05 13:34:08,966 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58926), 3: np.int64(56102), 4: np.int64(51191), 1: np.int64(47819), 0: np.int64(10086)}
2025-08-05 13:34:08,966 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:34:08,967 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.333933
2          T   17.144155
4   LOCTUDET   11.884615
5          M    8.796215
11        pT    6.346706
6   LOCTUPRI    5.182945
1       CNES    4.678835
10         N    3.634721
15  ESTDFIMT    3.519727
7       PTNM    2.981518
2025-08-05 13:34:09,921 - flag1.src.imputation - INFO - Ordinal model - Iter 35 - Val LogLoss: 0.5078 - Accuracy: 0.8482 - Classes: [0 1 2 3 4]
2025-08-05 13:34:09,924 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.333933
2          T   17.144155
4   LOCTUDET   11.884615
5          M    8.796215
11        pT    6.346706
6   LOCTUPRI    5.182945
1       CNES    4.678835
10         N    3.634721
15  ESTDFIMT    3.519727
7       PTNM    2.981518
2025-08-05 13:34:11,155 - root - DEBUG - Processed 50000/641691 samples (7.8%)
2025-08-05 13:34:14,612 - root - DEBUG - Processed 550000/641691 samples (85.7%)
2025-08-05 13:34:29,704 - flag1.src.imputation - INFO - Imputed 641691 MAR values.
2025-08-05 13:34:40,434 - flag1.src.imputation - INFO - Imputed 641691 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:34:51,304 - flag1.src.imputation - INFO - Imputed 641691 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:34:52,886 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:34:52,894 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814269
4     581281
2     486049
3     483424
1     426215
0      85259
99         0
Name: count, dtype: int64
2025-08-05 13:34:54,210 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:34:54,219 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814269
4     591692
3     502360
2     465266
1     416589
0      86321
99         0
Name: count, dtype: int64
2025-08-05 13:34:55,709 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:34:55,717 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814269
4     709874
2     448090
3     430565
1     387945
0      85754
99         0
Name: count, dtype: int64
2025-08-05 13:34:56,557 - flag1.src.imputation - INFO - Completed imputation 35/100 in 213.61 seconds
2025-08-05 13:34:56,557 - flag1.src.imputation - INFO - Estimated time remaining: 6.6 minutes
2025-08-05 13:34:56,557 - root - DEBUG - Imputation 35 completed in 213.61s
2025-08-05 13:34:56,583 - flag1.src.imputation - INFO - Starting imputation 36/100
2025-08-05 13:35:01,485 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:35:01,485 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:35:01,485 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:35:01,485 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:35:02,414 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 13:36:57,567 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:36:57,567 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:36:57,567 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:36:57,572 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:36:57,573 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:36:57,578 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136908), 1: np.int64(321144)}
2025-08-05 13:36:57,580 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284227), 1: np.int64(80286)}
2025-08-05 13:36:57,581 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:36:57,582 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   28.525117
3     LOCTUPRI   16.132266
11  DATAPRICON   10.529951
2     LOCTUDET    9.630857
6      CLITRAT    4.812440
10       ANTRI    4.564666
9     DTTRIAGE    4.144726
5     PRITRATH    3.988640
8      CLIATEN    3.943177
1         MUUH    3.457438
2025-08-05 13:36:59,047 - flag1.src.imputation - INFO - Binary model - Iter 36 - Val LogLoss: 0.2066 - Accuracy: 0.9351 - Classes: [0 1]
2025-08-05 13:36:59,050 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   28.525117
3     LOCTUPRI   16.132266
11  DATAPRICON   10.529951
2     LOCTUDET    9.630857
6      CLITRAT    4.812440
10       ANTRI    4.564666
9     DTTRIAGE    4.144726
5     PRITRATH    3.988640
8      CLIATEN    3.943177
1         MUUH    3.457438
2025-08-05 13:37:00,413 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:37:03,562 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:37:06,767 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:37:07,239 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 38.7% as 'não estadiável' (1), 61.3% as 'estadiável' (0)
2025-08-05 13:37:09,087 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:37:09,087 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:37:09,087 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:37:15,780 - flag1.src.imputation - DEBUG - Training ordinal model with 1121987 samples. Class distribution:
estadiamento_ordinal
0     51004
1    239006
2    295335
3    280935
4    255707
Name: count, dtype: int64
2025-08-05 13:37:15,788 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.399603952631166, 1: 0.9388776850790357, 2: 0.7598063216347537, 3: 0.7987520244896507, 4: 0.8775567348566915}
2025-08-05 13:37:42,590 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:37:42,590 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:37:42,591 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:37:42,593 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:37:42,594 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:37:42,598 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236268), 3: np.int64(224748), 4: np.int64(204565), 1: np.int64(191205), 0: np.int64(40803)}
2025-08-05 13:37:42,599 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59067), 3: np.int64(56187), 4: np.int64(51142), 1: np.int64(47801), 0: np.int64(10201)}
2025-08-05 13:37:42,600 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:37:42,601 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   18.835072
2          T   16.823989
4   LOCTUDET   11.903086
5          M    8.957752
11        pT    6.204294
6   LOCTUPRI    5.557595
1       CNES    4.906671
15  ESTDFIMT    3.593355
10         N    3.580865
3       MUUH    2.629722
2025-08-05 13:37:43,541 - flag1.src.imputation - INFO - Ordinal model - Iter 36 - Val LogLoss: 0.5117 - Accuracy: 0.8473 - Classes: [0 1 2 3 4]
2025-08-05 13:37:43,544 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   18.835072
2          T   16.823989
4   LOCTUDET   11.903086
5          M    8.957752
11        pT    6.204294
6   LOCTUPRI    5.557595
1       CNES    4.906671
15  ESTDFIMT    3.593355
10         N    3.580865
3       MUUH    2.629722
2025-08-05 13:37:44,862 - root - DEBUG - Processed 50000/645972 samples (7.7%)
2025-08-05 13:37:48,326 - root - DEBUG - Processed 550000/645972 samples (85.1%)
2025-08-05 13:38:03,545 - flag1.src.imputation - INFO - Imputed 645972 MAR values.
2025-08-05 13:38:14,363 - flag1.src.imputation - INFO - Imputed 645972 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:38:25,331 - flag1.src.imputation - INFO - Imputed 645972 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:38:26,886 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:38:26,894 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809988
4     579440
2     491359
3     488506
1     422080
0      85124
99         0
Name: count, dtype: int64
2025-08-05 13:38:28,318 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:38:28,327 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809988
4     593719
3     506542
2     469281
1     408641
0      88326
99         0
Name: count, dtype: int64
2025-08-05 13:38:29,544 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:38:29,553 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    809988
4     708451
2     456172
3     433301
1     382327
0      86258
99         0
Name: count, dtype: int64
2025-08-05 13:38:30,356 - flag1.src.imputation - INFO - Completed imputation 36/100 in 213.77 seconds
2025-08-05 13:38:30,356 - flag1.src.imputation - INFO - Estimated time remaining: 6.3 minutes
2025-08-05 13:38:30,356 - root - DEBUG - Imputation 36 completed in 213.77s
2025-08-05 13:38:30,385 - flag1.src.imputation - INFO - Starting imputation 37/100
2025-08-05 13:38:35,185 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:38:35,185 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:38:35,185 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:38:35,185 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:38:36,075 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:40:31,577 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:40:31,590 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:40:31,590 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:40:31,595 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:40:31,596 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:40:31,603 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1135913), 1: np.int64(322139)}
2025-08-05 13:40:31,605 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(283978), 1: np.int64(80535)}
2025-08-05 13:40:31,606 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:40:31,607 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.620003
3     LOCTUPRI   15.901517
11  DATAPRICON   10.658160
2     LOCTUDET    9.218615
6      CLITRAT    5.101966
10       ANTRI    4.894521
8      CLIATEN    4.297539
5     PRITRATH    4.049241
14  DATAINITRT    3.933802
1         MUUH    3.907246
2025-08-05 13:40:33,019 - flag1.src.imputation - INFO - Binary model - Iter 37 - Val LogLoss: 0.2011 - Accuracy: 0.9368 - Classes: [0 1]
2025-08-05 13:40:33,022 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.620003
3     LOCTUPRI   15.901517
11  DATAPRICON   10.658160
2     LOCTUDET    9.218615
6      CLITRAT    5.101966
10       ANTRI    4.894521
8      CLIATEN    4.297539
5     PRITRATH    4.049241
14  DATAINITRT    3.933802
1         MUUH    3.907246
2025-08-05 13:40:34,399 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:40:37,510 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:40:40,572 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:40:41,036 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.3% as 'não estadiável' (1), 60.7% as 'estadiável' (0)
2025-08-05 13:40:42,838 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:40:42,838 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:40:42,838 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:40:49,444 - flag1.src.imputation - DEBUG - Training ordinal model with 1120965 samples. Class distribution:
estadiamento_ordinal
0     50708
1    237798
2    295647
3    281083
4    255729
Name: count, dtype: int64
2025-08-05 13:40:49,452 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.421255028792301, 1: 0.9427875760098907, 2: 0.7583131234208363, 3: 0.7976042663554893, 4: 0.876681956289666}
2025-08-05 13:41:15,920 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:41:15,921 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:41:15,921 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:41:15,924 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:41:15,925 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:41:15,932 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236518), 3: np.int64(224867), 4: np.int64(204583), 1: np.int64(190238), 0: np.int64(40566)}
2025-08-05 13:41:15,935 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59129), 3: np.int64(56216), 4: np.int64(51146), 1: np.int64(47560), 0: np.int64(10142)}
2025-08-05 13:41:15,936 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:41:15,937 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.188956
2          T   17.203024
4   LOCTUDET   11.729243
5          M    8.920247
11        pT    6.177385
6   LOCTUPRI    5.737508
1       CNES    4.772997
15  ESTDFIMT    3.664894
10         N    3.585807
3       MUUH    2.675484
2025-08-05 13:41:16,931 - flag1.src.imputation - INFO - Ordinal model - Iter 37 - Val LogLoss: 0.5069 - Accuracy: 0.8486 - Classes: [0 1 2 3 4]
2025-08-05 13:41:16,934 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.188956
2          T   17.203024
4   LOCTUDET   11.729243
5          M    8.920247
11        pT    6.177385
6   LOCTUPRI    5.737508
1       CNES    4.772997
15  ESTDFIMT    3.664894
10         N    3.585807
3       MUUH    2.675484
2025-08-05 13:41:18,147 - root - DEBUG - Processed 50000/640012 samples (7.8%)
2025-08-05 13:41:21,567 - root - DEBUG - Processed 550000/640012 samples (85.9%)
2025-08-05 13:41:36,637 - flag1.src.imputation - INFO - Imputed 640012 MAR values.
2025-08-05 13:41:47,340 - flag1.src.imputation - INFO - Imputed 640012 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:41:58,194 - flag1.src.imputation - INFO - Imputed 640012 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:41:59,723 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:41:59,731 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815948
4     578010
2     486213
3     482697
1     423083
0      90546
99         0
Name: count, dtype: int64
2025-08-05 13:42:01,017 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:42:01,025 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815948
4     591111
3     502793
2     467617
1     408887
0      90141
99         0
Name: count, dtype: int64
2025-08-05 13:42:02,331 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:42:02,339 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    815948
4     697925
2     453912
3     431375
1     388328
0      89009
99         0
Name: count, dtype: int64
2025-08-05 13:42:03,162 - flag1.src.imputation - INFO - Completed imputation 37/100 in 212.78 seconds
2025-08-05 13:42:03,162 - flag1.src.imputation - INFO - Estimated time remaining: 6.0 minutes
2025-08-05 13:42:03,162 - root - DEBUG - Imputation 37 completed in 212.78s
2025-08-05 13:42:03,162 - flag1.src.imputation - INFO - Starting imputation 38/100
2025-08-05 13:42:07,964 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:42:07,964 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:42:07,965 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:42:07,965 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:42:08,862 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.54 for binary classification
2025-08-05 13:44:04,032 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:44:04,032 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:44:04,032 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:44:04,037 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:44:04,038 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:44:04,044 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136689), 1: np.int64(321363)}
2025-08-05 13:44:04,046 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284172), 1: np.int64(80341)}
2025-08-05 13:44:04,046 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:44:04,047 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.541164
3     LOCTUPRI   16.150847
11  DATAPRICON   10.422116
2     LOCTUDET    9.633404
10       ANTRI    4.732429
6      CLITRAT    4.490636
8      CLIATEN    4.292207
5     PRITRATH    4.182623
1         MUUH    4.054167
9     DTTRIAGE    4.036284
2025-08-05 13:44:05,452 - flag1.src.imputation - INFO - Binary model - Iter 38 - Val LogLoss: 0.2034 - Accuracy: 0.9361 - Classes: [0 1]
2025-08-05 13:44:05,455 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.541164
3     LOCTUPRI   16.150847
11  DATAPRICON   10.422116
2     LOCTUDET    9.633404
10       ANTRI    4.732429
6      CLITRAT    4.490636
8      CLIATEN    4.292207
5     PRITRATH    4.182623
1         MUUH    4.054167
9     DTTRIAGE    4.036284
2025-08-05 13:44:06,748 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:44:09,923 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:44:13,097 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:44:13,579 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.1% as 'não estadiável' (1), 60.9% as 'estadiável' (0)
2025-08-05 13:44:15,423 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:44:15,423 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:44:15,423 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:44:22,150 - flag1.src.imputation - DEBUG - Training ordinal model with 1122034 samples. Class distribution:
estadiamento_ordinal
0     50667
1    237849
2    295190
3    282257
4    256071
Name: count, dtype: int64
2025-08-05 13:44:22,158 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.429052440444471, 1: 0.9434843114749274, 2: 0.7602113892747044, 3: 0.7950442327382492, 4: 0.8763460134103432}
2025-08-05 13:44:48,954 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:44:48,954 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:44:48,954 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:44:48,957 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:44:48,958 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:44:48,962 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(236152), 3: np.int64(225805), 4: np.int64(204857), 1: np.int64(190279), 0: np.int64(40534)}
2025-08-05 13:44:48,963 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(59038), 3: np.int64(56452), 4: np.int64(51214), 1: np.int64(47570), 0: np.int64(10133)}
2025-08-05 13:44:48,964 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:44:48,965 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.253400
2          T   16.903296
4   LOCTUDET   11.781059
5          M    8.718771
11        pT    6.031488
6   LOCTUPRI    5.543595
1       CNES    4.893781
10         N    3.635210
15  ESTDFIMT    3.567049
3       MUUH    2.948218
2025-08-05 13:44:49,907 - flag1.src.imputation - INFO - Ordinal model - Iter 38 - Val LogLoss: 0.5089 - Accuracy: 0.8476 - Classes: [0 1 2 3 4]
2025-08-05 13:44:49,910 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.253400
2          T   16.903296
4   LOCTUDET   11.781059
5          M    8.718771
11        pT    6.031488
6   LOCTUPRI    5.543595
1       CNES    4.893781
10         N    3.635210
15  ESTDFIMT    3.567049
3       MUUH    2.948218
2025-08-05 13:44:51,144 - root - DEBUG - Processed 50000/641388 samples (7.8%)
2025-08-05 13:44:54,663 - root - DEBUG - Processed 550000/641388 samples (85.8%)
2025-08-05 13:45:09,802 - flag1.src.imputation - INFO - Imputed 641388 MAR values.
2025-08-05 13:45:20,544 - flag1.src.imputation - INFO - Imputed 641388 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:45:31,428 - flag1.src.imputation - INFO - Imputed 641388 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:45:32,994 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:45:33,002 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814572
4     583472
2     487650
3     480916
1     424402
0      85485
99         0
Name: count, dtype: int64
2025-08-05 13:45:34,334 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:45:34,343 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814572
4     595958
3     500971
2     467738
1     411051
0      86207
99         0
Name: count, dtype: int64
2025-08-05 13:45:35,696 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:45:35,707 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    814572
4     704166
2     453377
3     429225
1     387737
0      87420
99         0
Name: count, dtype: int64
2025-08-05 13:45:36,536 - flag1.src.imputation - INFO - Completed imputation 38/100 in 213.37 seconds
2025-08-05 13:45:36,536 - flag1.src.imputation - INFO - Estimated time remaining: 5.8 minutes
2025-08-05 13:45:36,563 - root - DEBUG - Imputation 38 completed in 213.40s
2025-08-05 13:45:36,563 - flag1.src.imputation - INFO - Starting imputation 39/100
2025-08-05 13:45:41,342 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:45:41,342 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:45:41,342 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:45:41,342 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:45:42,221 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.53 for binary classification
2025-08-05 13:47:36,961 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:47:36,971 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:47:36,972 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:47:36,979 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:47:36,981 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:47:36,993 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1136494), 1: np.int64(321558)}
2025-08-05 13:47:36,995 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284124), 1: np.int64(80389)}
2025-08-05 13:47:36,996 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:47:36,997 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.855567
3     LOCTUPRI   16.086829
11  DATAPRICON   10.971728
2     LOCTUDET   10.297102
10       ANTRI    4.526296
6      CLITRAT    4.316668
5     PRITRATH    4.246743
9     DTTRIAGE    4.148617
8      CLIATEN    4.120893
1         MUUH    3.558292
2025-08-05 13:47:38,397 - flag1.src.imputation - INFO - Binary model - Iter 39 - Val LogLoss: 0.2029 - Accuracy: 0.9363 - Classes: [0 1]
2025-08-05 13:47:38,400 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.855567
3     LOCTUPRI   16.086829
11  DATAPRICON   10.971728
2     LOCTUDET   10.297102
10       ANTRI    4.526296
6      CLITRAT    4.316668
5     PRITRATH    4.246743
9     DTTRIAGE    4.148617
8      CLIATEN    4.120893
1         MUUH    3.558292
2025-08-05 13:47:39,649 - root - DEBUG - Processed 50000/1053932 samples (4.7%)
2025-08-05 13:47:42,718 - root - DEBUG - Processed 550000/1053932 samples (52.2%)
2025-08-05 13:47:45,763 - root - DEBUG - Processed 1050000/1053932 samples (99.6%)
2025-08-05 13:47:46,219 - flag1.src.imputation - INFO - Imputed 1053932 missing flags: 39.0% as 'não estadiável' (1), 61.0% as 'estadiável' (0)
2025-08-05 13:47:48,008 - flag1.src.imputation - INFO - [Ordinal Model] Training with 25 features.
2025-08-05 13:47:48,009 - flag1.src.imputation - DEBUG - Features used: ['TNM', 'CNES', 'T', 'MUUH', 'LOCTUDET', 'M', 'LOCTUPRI', 'PTNM', 'UFUH', 'PRITRATH', 'N', 'pT', 'pM', 'OUTROESTA', 'CLITRAT', 'ESTDFIMT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'pN', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:47:48,009 - flag1.src.imputation - DEBUG - Excluded variables: ['ESTADIAM', 'estadiamento_ordinal', 'flag_nao_estadiavel']
2025-08-05 13:47:54,476 - flag1.src.imputation - DEBUG - Training ordinal model with 1120646 samples. Class distribution:
estadiamento_ordinal
0     51181
1    238217
2    294408
3    281300
4    255540
Name: count, dtype: int64
2025-08-05 13:47:54,484 - flag1.src.imputation - DEBUG - Using class weights: {0: 4.379148512143178, 1: 0.9408614834373701, 2: 0.761287736746284, 3: 0.7967621756132243, 4: 0.8770806918682007}
2025-08-05 13:48:21,008 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:48:21,008 - flag1.src.imputation - DEBUG - Model type: ordinal
2025-08-05 13:48:21,008 - flag1.src.imputation - DEBUG - Model classes: [0 1 2 3 4]
2025-08-05 13:48:21,011 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1 2 3 4]
2025-08-05 13:48:21,011 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1 2 3 4]
2025-08-05 13:48:21,015 - flag1.src.imputation - DEBUG - Class distribution - Train: {2: np.int64(235526), 3: np.int64(225040), 4: np.int64(204432), 1: np.int64(190573), 0: np.int64(40945)}
2025-08-05 13:48:21,016 - flag1.src.imputation - DEBUG - Class distribution - Val: {2: np.int64(58882), 3: np.int64(56260), 4: np.int64(51108), 1: np.int64(47644), 0: np.int64(10236)}
2025-08-05 13:48:21,017 - flag1.src.imputation - DEBUG - Top 10 important features for ordinal model:
2025-08-05 13:48:21,018 - flag1.src.imputation - DEBUG -      feature  importance
0        TNM   19.262364
2          T   17.320922
4   LOCTUDET   11.587219
5          M    8.860316
11        pT    6.341703
6   LOCTUPRI    5.108102
1       CNES    4.816471
10         N    3.573042
15  ESTDFIMT    3.555112
3       MUUH    2.831649
2025-08-05 13:48:21,969 - flag1.src.imputation - INFO - Ordinal model - Iter 39 - Val LogLoss: 0.5123 - Accuracy: 0.8474 - Classes: [0 1 2 3 4]
2025-08-05 13:48:21,972 - flag1.src.imputation - DEBUG - Top 10 important features:
     feature  importance
0        TNM   19.262364
2          T   17.320922
4   LOCTUDET   11.587219
5          M    8.860316
11        pT    6.341703
6   LOCTUPRI    5.108102
1       CNES    4.816471
10         N    3.573042
15  ESTDFIMT    3.555112
3       MUUH    2.831649
2025-08-05 13:48:23,144 - root - DEBUG - Processed 50000/643222 samples (7.8%)
2025-08-05 13:48:26,567 - root - DEBUG - Processed 550000/643222 samples (85.5%)
2025-08-05 13:48:41,709 - flag1.src.imputation - INFO - Imputed 643222 MAR values.
2025-08-05 13:48:52,487 - flag1.src.imputation - INFO - Imputed 643222 values for MNAR scenario 'mnar_adv'.
2025-08-05 13:49:03,392 - flag1.src.imputation - INFO - Imputed 643222 values for MNAR scenario 'mnar_s4'.
2025-08-05 13:49:04,902 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:49:04,910 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812738
4     584156
2     487929
3     480825
1     423601
0      87248
99         0
Name: count, dtype: int64
2025-08-05 13:49:06,283 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:49:06,291 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812738
4     600472
3     500299
2     465670
1     410054
0      87264
99         0
Name: count, dtype: int64
2025-08-05 13:49:07,708 - flag1.src.imputation - INFO - Reconstructed 'ESTADIAM' column from imputed values.
2025-08-05 13:49:07,720 - flag1.src.imputation - DEBUG - Final ESTADIAM distribution:
ESTADIAM
88    812738
4     710989
2     451527
3     427137
1     388391
0      85715
99         0
Name: count, dtype: int64
2025-08-05 13:49:08,530 - flag1.src.imputation - INFO - Completed imputation 39/100 in 211.97 seconds
2025-08-05 13:49:08,531 - flag1.src.imputation - INFO - Estimated time remaining: 5.5 minutes
2025-08-05 13:49:08,531 - root - DEBUG - Imputation 39 completed in 211.97s
2025-08-05 13:49:08,531 - flag1.src.imputation - INFO - Starting imputation 40/100
2025-08-05 13:49:13,276 - flag1.src.imputation - INFO - [Binary Model] Training with 15 features: ['CNES', 'MUUH', 'LOCTUDET', 'LOCTUPRI', 'UFUH', 'PRITRATH', 'CLITRAT', 'ESTADRES', 'CLIATEN', 'DTTRIAGE', 'ANTRI', 'DATAPRICON', 'obitcons', 'Quimioterapia_TRAT', 'DATAINITRT']
2025-08-05 13:49:13,276 - flag1.src.imputation - DEBUG - Excluded staging variables: ['TNM', 'OUTROESTA', 'T', 'N', 'M', 'pT', 'pN', 'pM', 'PTNM', 'ESTDFIMT', 'estadiamento_ordinal', 'flag_nao_estadiavel', 'flag_nao_estadiavel']
2025-08-05 13:49:13,276 - flag1.src.imputation - DEBUG - Original cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 22]
2025-08-05 13:49:13,276 - flag1.src.imputation - DEBUG - Filtered cat_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8]
2025-08-05 13:49:14,151 - flag1.src.imputation - DEBUG - Using scale_pos_weight=3.55 for binary classification
2025-08-05 13:51:09,806 - flag1.src.imputation - DEBUG - Applied temperature scaling: 0.5
2025-08-05 13:51:09,857 - flag1.src.imputation - DEBUG - Model type: binary
2025-08-05 13:51:09,874 - flag1.src.imputation - DEBUG - Model classes: [0 1]
2025-08-05 13:51:09,908 - flag1.src.imputation - DEBUG - Unique y_train values: [0 1]
2025-08-05 13:51:09,910 - flag1.src.imputation - DEBUG - Unique y_val values: [0 1]
2025-08-05 13:51:10,096 - flag1.src.imputation - DEBUG - Class distribution - Train: {0: np.int64(1137477), 1: np.int64(320575)}
2025-08-05 13:51:10,102 - flag1.src.imputation - DEBUG - Class distribution - Val: {0: np.int64(284369), 1: np.int64(80144)}
2025-08-05 13:51:10,224 - flag1.src.imputation - DEBUG - Top 10 important features for binary model:
2025-08-05 13:51:10,244 - flag1.src.imputation - DEBUG -        feature  importance
0         CNES   27.678279
3     LOCTUPRI   15.318262
11  DATAPRICON   10.249889
2     LOCTUDET   10.070890
10       ANTRI    4.850467
6      CLITRAT    4.747572
1         MUUH    4.249843
9     DTTRIAGE    4.156538
5     PRITRATH    4.139622
8      CLIATEN    3.893810
2025-08-05 13:51:11,856 - flag1.src.imputation - INFO - Binary model - Iter 40 - Val LogLoss: 0.2035 - Accuracy: 0.9364 - Classes: [0 1]
2025-08-05 13:51:11,859 - flag1.src.imputation - DEBUG - Top 10 important features:
       feature  importance
0         CNES   27.678279
3     LOCTUPRI   15.318262
11  DATAPRICON   10.249889
2     LOCTUDET   10.070890
10       ANTRI    4.850467
6      CLITRAT    4.747572
1         MUUH    4.249843
9     DTTRIAGE    4.156538
5     PRITRATH    4.139622
8      CLIATEN    3.893810
